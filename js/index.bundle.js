(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();const e=new Map([["320x480","iPhone 4S, 4, 3GS, 3G, 1st gen"],["320x568","iPhone 5, SE 1st Gen, 5C, 5S"],["375x667","iPhone SE 2nd Gen, 6, 6S, 7, 8"],["375x812","iPhone X, XS, 11 Pro, 12 Mini, 13 Mini"],["390x844","iPhone 13, 13 Pro, 12, 12 Pro"],["414x736","iPhone 8+"],["414x896","iPhone 11, XR, XS Max, 11 Pro Max"],["428x926","iPhone 13 Pro Max, 12 Pro Max"],["476x847","iPhone 7+, 6+, 6S+"],["744x1133","iPad Mini 6th Gen"],["768x1024","iPad Mini (5th Gen), iPad (1-6th Gen), iPad Pro (1st Gen 9.7), iPad Mini (1-4), iPad Air(1-2)"],["810x1080","iPad 7-9th Gen"],["820x1180","iPad Air (4th gen)"],["834x1194","iPad Pro (3-5th Gen 11)"],["834x1112","iPad Air (3rd gen), iPad Pro (2nd gen 10.5)"],["1024x1366","iPad Pro (1-5th Gen 12.9)"]]),r=new Map([["Win32","Windows"],["Linux","Linux"],["MacIntel","Mac OS"]]),n=()=>{const t=window.navigator.userAgent.toLowerCase();return t.includes("mobi")?t.includes("android")?(()=>{const t=window.navigator.userAgent,e=t.indexOf("Android");if(-1===e)return"Android";const r=t.slice(e),n=r.slice(r.indexOf("; ")+2,r.indexOf(")"));return n?n.trim().split(" ")[0]:"Android"})():(()=>{const t=`${window.screen.width}x${window.screen.height}`;return e.get(t)??"iPhone/iPad"})():(()=>{const t=window.navigator,e=t?.userAgentData?.platform||t?.platform||"unknown";return r.get(e)??"Desktop"})()},i=()=>{const t=navigator;return t.devicePosture?.type||"not-supported"},s=async()=>{if(navigator.storage&&navigator.storage.estimate){const{usage:t=0,quota:e=0}=await navigator.storage.estimate(),r={usageMB:(t/1048576).toFixed(2),quotaMB:(e/1048576).toFixed(2)};return JSON.stringify(r)}return""};var o,a=(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),c=function(){function t(){}return t.prototype.createGauge=function(t,e){return v},t.prototype.createHistogram=function(t,e){return w},t.prototype.createCounter=function(t,e){return S},t.prototype.createUpDownCounter=function(t,e){return b},t.prototype.createObservableGauge=function(t,e){return E},t.prototype.createObservableCounter=function(t,e){return T},t.prototype.createObservableUpDownCounter=function(t,e){return A},t.prototype.addBatchObservableCallback=function(t,e){},t.prototype.removeBatchObservableCallback=function(t){},t}(),u=function(){},l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.add=function(t,e){},e}(u),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.add=function(t,e){},e}(u),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.record=function(t,e){},e}(u),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.record=function(t,e){},e}(u),m=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.removeCallback=function(t){},t}(),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e}(m),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e}(m),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e}(m),y=new c,S=new l,v=new d,w=new p,b=new h,T=new g,E=new _,A=new f,x=new(function(){function t(){}return t.prototype.getMeter=function(t,e,r){return y},t}()),C="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof t.g?t.g:{},M="1.9.0",O=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,P=function(t){var e=new Set([t]),r=new Set,n=t.match(O);if(!n)return function(){return!1};var i=+n[1],s=+n[2],o=+n[3];if(null!=n[4])return function(e){return e===t};function a(t){return r.add(t),!1}function c(t){return e.add(t),!0}return function(t){if(e.has(t))return!0;if(r.has(t))return!1;var n=t.match(O);if(!n)return a(t);var u=+n[1],l=+n[2],h=+n[3];return null!=n[4]||i!==u?a(t):0===i?s===l&&o<=h?c(t):a(t):s<=l?c(t):a(t)}}(M),L=M.split(".")[0],R=Symbol.for("opentelemetry.js.api."+L),N=C;function I(t,e,r,n){var i;void 0===n&&(n=!1);var s=N[R]=null!==(i=N[R])&&void 0!==i?i:{version:M};if(!n&&s[t]){var o=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return r.error(o.stack||o.message),!1}return s.version!==M?(o=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+t+" does not match previously registered API v"+M),r.error(o.stack||o.message),!1):(s[t]=e,r.debug("@opentelemetry/api: Registered a global for "+t+" v"+M+"."),!0)}function U(t){var e,r,n=null===(e=N[R])||void 0===e?void 0:e.version;if(n&&P(n))return null===(r=N[R])||void 0===r?void 0:r[t]}function k(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+M+".");var r=N[R];r&&delete r[t]}var D,B=function(){function t(t){this._namespace=t.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return F("debug",this._namespace,t)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return F("error",this._namespace,t)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return F("info",this._namespace,t)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return F("warn",this._namespace,t)},t.prototype.verbose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return F("verbose",this._namespace,t)},t}();function F(t,e,r){var n=U("diag");if(n)return r.unshift(e),n[t].apply(n,function(t,e,r){if(r||2===arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}([],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}(r),!1))}!function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"}(D||(D={}));var G=function(){function t(){function t(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=U("diag");if(n)return n[t].apply(n,function(t,e,r){if(r||2===arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}([],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}(e),!1))}}var e=this;e.setLogger=function(t,r){var n,i,s;if(void 0===r&&(r={logLevel:D.INFO}),t===e){var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return e.error(null!==(n=o.stack)&&void 0!==n?n:o.message),!1}"number"==typeof r&&(r={logLevel:r});var a=U("diag"),c=function(t,e){function r(r,n){var i=e[r];return"function"==typeof i&&t>=n?i.bind(e):function(){}}return t<D.NONE?t=D.NONE:t>D.ALL&&(t=D.ALL),e=e||{},{error:r("error",D.ERROR),warn:r("warn",D.WARN),info:r("info",D.INFO),debug:r("debug",D.DEBUG),verbose:r("verbose",D.VERBOSE)}}(null!==(i=r.logLevel)&&void 0!==i?i:D.INFO,t);if(a&&!r.suppressOverrideMessage){var u=null!==(s=(new Error).stack)&&void 0!==s?s:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+u),c.warn("Current logger will overwrite one already registered from "+u)}return I("diag",c,e,!0)},e.disable=function(){k("diag",e)},e.createComponentLogger=function(t){return new B(t)},e.verbose=t("verbose"),e.debug=t("debug"),e.info=t("info"),e.warn=t("warn"),e.error=t("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t}(),V="metrics",$=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(t){return I(V,t,G.instance())},t.prototype.getMeterProvider=function(){return U(V)||x},t.prototype.getMeter=function(t,e,r){return this.getMeterProvider().getMeter(t,e,r)},t.prototype.disable=function(){k(V,G.instance())},t}().getInstance(),z=G.instance();const j="exception.message",H="exception.type",q="service.name",W="service.version",X="telemetry.sdk.language",Y="telemetry.sdk.name",Q="telemetry.sdk.version",K="process.runtime.name",J={[Y]:"opentelemetry",[K]:"browser",[X]:"webjs",[Q]:"2.2.0"},Z=t=>null!==t&&"object"==typeof t&&"function"==typeof t.then;class tt{_rawAttributes;_asyncAttributesPending=!1;_schemaUrl;_memoizedAttributes;static FromAttributeList(t,e){const r=new tt({},e);return r._rawAttributes=nt(t),r._asyncAttributesPending=t.filter(([t,e])=>Z(e)).length>0,r}constructor(t,e){const r=t.attributes??{};this._rawAttributes=Object.entries(r).map(([t,e])=>(Z(e)&&(this._asyncAttributesPending=!0),[t,e])),this._rawAttributes=nt(this._rawAttributes),this._schemaUrl=function(t){if("string"==typeof t||void 0===t)return t;z.warn("Schema URL must be string or undefined, got %s. Schema URL will be ignored.",t)}(e?.schemaUrl)}get asyncAttributesPending(){return this._asyncAttributesPending}async waitForAsyncAttributes(){if(this.asyncAttributesPending){for(let t=0;t<this._rawAttributes.length;t++){const[e,r]=this._rawAttributes[t];this._rawAttributes[t]=[e,Z(r)?await r:r]}this._asyncAttributesPending=!1}}get attributes(){if(this.asyncAttributesPending&&z.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;const t={};for(const[e,r]of this._rawAttributes)Z(r)?z.debug(`Unsettled resource attribute ${e} skipped`):null!=r&&(t[e]??=r);return this._asyncAttributesPending||(this._memoizedAttributes=t),t}getRawAttributes(){return this._rawAttributes}get schemaUrl(){return this._schemaUrl}merge(t){if(null==t)return this;const e=function(t,e){const r=t?.schemaUrl,n=e?.schemaUrl;return void 0===r||""===r?n:void 0===n||""===n||r===n?r:void z.warn('Schema URL merge conflict: old resource has "%s", updating resource has "%s". Resulting resource will have undefined Schema URL.',r,n)}(this,t),r=e?{schemaUrl:e}:void 0;return tt.FromAttributeList([...t.getRawAttributes(),...this.getRawAttributes()],r)}}function et(t,e){return tt.FromAttributeList(Object.entries(t),e)}function rt(){return et({[q]:"unknown_service",[X]:J[X],[Y]:J[Y],[Q]:J[Q]})}function nt(t){return t.map(([t,e])=>Z(e)?[t,e.catch(e=>{z.debug("promise rejection for resource attribute: %s - %s",t,e)})]:[t,e])}const it=Function.prototype.toString,st=it.call(Object),ot=Object.getPrototypeOf,at=Object.prototype,ct=at.hasOwnProperty,ut=Symbol?Symbol.toStringTag:void 0,lt=at.toString;function ht(t){if(!function(t){return null!=t&&"object"==typeof t}(t)||"[object Object]"!==function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":ut&&ut in Object(t)?function(t){const e=ct.call(t,ut),r=t[ut];let n=!1;try{t[ut]=void 0,n=!0}catch{}const i=lt.call(t);return n&&(e?t[ut]=r:delete t[ut]),i}(t):function(t){return lt.call(t)}(t)}(t))return!1;const e=ot(t);if(null===e)return!0;const r=ct.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&it.call(r)===st}function dt(t){return gt(t)?t.slice():t}function pt(t,e,r=0,n){let i;if(!(r>20)){if(r++,yt(t)||yt(e)||_t(e))i=dt(e);else if(gt(t)){if(i=t.slice(),gt(e))for(let t=0,r=e.length;t<r;t++)i.push(dt(e[t]));else if(ft(e)){const t=Object.keys(e);for(let r=0,n=t.length;r<n;r++){const n=t[r];i[n]=dt(e[n])}}}else if(ft(t))if(ft(e)){if(!function(t,e){return!(!ht(t)||!ht(e))}(t,e))return e;i=Object.assign({},t);const s=Object.keys(e);for(let o=0,a=s.length;o<a;o++){const a=s[o],c=e[a];if(yt(c))void 0===c?delete i[a]:i[a]=c;else{const s=i[a],o=c;if(mt(t,a,n)||mt(e,a,n))delete i[a];else{if(ft(s)&&ft(o)){const r=n.get(s)||[],i=n.get(o)||[];r.push({obj:t,key:a}),i.push({obj:e,key:a}),n.set(s,r),n.set(o,i)}i[a]=pt(i[a],c,r,n)}}}}else i=e;return i}}function mt(t,e,r){const n=r.get(t[e])||[];for(let r=0,i=n.length;r<i;r++){const i=n[r];if(i.key===e&&i.obj===t)return!0}return!1}function gt(t){return Array.isArray(t)}function _t(t){return"function"==typeof t}function ft(t){return!yt(t)&&!gt(t)&&!_t(t)&&"object"==typeof t}function yt(t){return"string"==typeof t||"number"==typeof t||"boolean"==typeof t||void 0===t||t instanceof Date||t instanceof RegExp||null===t}function St(t){return Symbol.for(t)}var vt,wt=new function t(e){var r=this;r._currentContext=e?new Map(e):new Map,r.getValue=function(t){return r._currentContext.get(t)},r.setValue=function(e,n){var i=new t(r._currentContext);return i._currentContext.set(e,n),i},r.deleteValue=function(e){var n=new t(r._currentContext);return n._currentContext.delete(e),n}},bt=function(){function t(){}return t.prototype.active=function(){return wt},t.prototype.with=function(t,e,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];return e.call.apply(e,function(t,e,r){if(r||2===arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}([r],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}(n),!1))},t.prototype.bind=function(t,e){return e},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t}(),Tt="context",Et=new bt,At=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(t){return I(Tt,t,G.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(t,e,r){for(var n,i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return(n=this._getContextManager()).with.apply(n,function(t,e,r){if(r||2===arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}([t,e,r],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}(i),!1))},t.prototype.bind=function(t,e){return this._getContextManager().bind(t,e)},t.prototype._getContextManager=function(){return U(Tt)||Et},t.prototype.disable=function(){this._getContextManager().disable(),k(Tt,G.instance())},t}(),xt=At.getInstance();!function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"}(vt||(vt={}));var Ct="0000000000000000",Mt="00000000000000000000000000000000",Ot={traceId:Mt,spanId:Ct,traceFlags:vt.NONE},Pt=function(){function t(t){void 0===t&&(t=Ot),this._spanContext=t}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(t,e){return this},t.prototype.setAttributes=function(t){return this},t.prototype.addEvent=function(t,e){return this},t.prototype.addLink=function(t){return this},t.prototype.addLinks=function(t){return this},t.prototype.setStatus=function(t){return this},t.prototype.updateName=function(t){return this},t.prototype.end=function(t){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(t,e){},t}(),Lt=St("OpenTelemetry Context Key SPAN");function Rt(t){return t.getValue(Lt)||void 0}function Nt(){return Rt(At.getInstance().active())}function It(t,e){return t.setValue(Lt,e)}function Ut(t){return t.deleteValue(Lt)}function kt(t,e){return It(t,new Pt(e))}function Dt(t){var e;return null===(e=Rt(t))||void 0===e?void 0:e.spanContext()}var Bt=/^([0-9a-f]{32})$/i,Ft=/^[0-9a-f]{16}$/i;function Gt(t){return Bt.test(t)&&t!==Mt}function Vt(t){return Gt(t.traceId)&&(e=t.spanId,Ft.test(e)&&e!==Ct);var e}function $t(t){return new Pt(t)}var zt,jt,Ht=At.getInstance(),qt=function(){function t(){}return t.prototype.startSpan=function(t,e,r){if(void 0===r&&(r=Ht.active()),Boolean(null==e?void 0:e.root))return new Pt;var n,i=r&&Dt(r);return"object"==typeof(n=i)&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&Vt(i)?new Pt(i):new Pt},t.prototype.startActiveSpan=function(t,e,r,n){var i,s,o;if(!(arguments.length<2)){2===arguments.length?o=e:3===arguments.length?(i=e,o=r):(i=e,s=r,o=n);var a=null!=s?s:Ht.active(),c=this.startSpan(t,i,a),u=It(a,c);return Ht.with(u,o,void 0,c)}},t}(),Wt=new qt,Xt=function(){function t(t,e,r,n){this._provider=t,this.name=e,this.version=r,this.options=n}return t.prototype.startSpan=function(t,e,r){return this._getTracer().startSpan(t,e,r)},t.prototype.startActiveSpan=function(t,e,r,n){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):Wt},t}(),Yt=new(function(){function t(){}return t.prototype.getTracer=function(t,e,r){return new qt},t}()),Qt=function(){function t(){}return t.prototype.getTracer=function(t,e,r){var n;return null!==(n=this.getDelegateTracer(t,e,r))&&void 0!==n?n:new Xt(this,t,e,r)},t.prototype.getDelegate=function(){var t;return null!==(t=this._delegate)&&void 0!==t?t:Yt},t.prototype.setDelegate=function(t){this._delegate=t},t.prototype.getDelegateTracer=function(t,e,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getTracer(t,e,r)},t}(),Kt="trace",Jt=function(){function t(){this._proxyTracerProvider=new Qt,this.wrapSpanContext=$t,this.isSpanContextValid=Vt,this.deleteSpan=Ut,this.getSpan=Rt,this.getActiveSpan=Nt,this.getSpanContext=Dt,this.setSpan=It,this.setSpanContext=kt}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(t){var e=I(Kt,this._proxyTracerProvider,G.instance());return e&&this._proxyTracerProvider.setDelegate(t),e},t.prototype.getTracerProvider=function(){return U(Kt)||this._proxyTracerProvider},t.prototype.getTracer=function(t,e){return this.getTracerProvider().getTracer(t,e)},t.prototype.disable=function(){k(Kt,G.instance()),this._proxyTracerProvider=new Qt},t}().getInstance();!function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"}(zt||(zt={})),function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(jt||(jt={}));const Zt=St("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function te(t){return t.setValue(Zt,!0)}function ee(t){return!0===t.getValue(Zt)}function re(t){const e={};if("object"!=typeof t||null==t)return e;for(const r in t){if(!Object.prototype.hasOwnProperty.call(t,r))continue;if(!ne(r)){z.warn(`Invalid attribute key: ${r}`);continue}const n=t[r];ie(n)?Array.isArray(n)?e[r]=n.slice():e[r]=n:z.warn(`Invalid attribute value set for key: ${r}`)}return e}function ne(t){return"string"==typeof t&&""!==t}function ie(t){return null==t||(Array.isArray(t)?function(t){let e;for(const r of t){if(null==r)continue;const t=typeof r;if(t!==e){if(!e){if(se(t)){e=t;continue}return!1}return!1}}return!0}(t):se(typeof t))}function se(t){switch(t){case"number":case"boolean":case"string":return!0}return!1}var oe;!function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"}(oe||(oe={}));const ae=performance,ce=Math.pow(10,6),ue=Math.pow(10,9);function le(t){const e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*ce)]}function he(){let t=ae.timeOrigin;if("number"!=typeof t){const e=ae;t=e.timing&&e.timing.fetchStart}return t}function de(t){return ye(le(he()),le("number"==typeof t?t:ae.now()))}function pe(t){if(_e(t))return t;if("number"==typeof t)return t<he()?de(t):le(t);if(t instanceof Date)return le(t.getTime());throw TypeError("Invalid input type")}function me(t){return t[0]*ue+t[1]}function ge(t){return 1e6*t[0]+t[1]/1e3}function _e(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}function fe(t){return _e(t)||"number"==typeof t||t instanceof Date}function ye(t,e){const r=[t[0]+e[0],t[1]+e[1]];return r[1]>=ue&&(r[1]-=ue,r[0]+=1),r}class Se{_spanContext;kind;parentSpanContext;attributes={};links=[];events=[];startTime;resource;instrumentationScope;_droppedAttributesCount=0;_droppedEventsCount=0;_droppedLinksCount=0;name;status={code:oe.UNSET};endTime=[0,0];_ended=!1;_duration=[-1,-1];_spanProcessor;_spanLimits;_attributeValueLengthLimit;_performanceStartTime;_performanceOffset;_startTimeProvided;constructor(t){const e=Date.now();this._spanContext=t.spanContext,this._performanceStartTime=ae.now(),this._performanceOffset=e-(this._performanceStartTime+he()),this._startTimeProvided=null!=t.startTime,this._spanLimits=t.spanLimits,this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,this._spanProcessor=t.spanProcessor,this.name=t.name,this.parentSpanContext=t.parentSpanContext,this.kind=t.kind,this.links=t.links||[],this.startTime=this._getTime(t.startTime??e),this.resource=t.resource,this.instrumentationScope=t.scope,null!=t.attributes&&this.setAttributes(t.attributes),this._spanProcessor.onStart(this,t.context)}spanContext(){return this._spanContext}setAttribute(t,e){if(null==e||this._isSpanEnded())return this;if(0===t.length)return z.warn(`Invalid attribute key: ${t}`),this;if(!ie(e))return z.warn(`Invalid attribute value set for key: ${t}`),this;const{attributeCountLimit:r}=this._spanLimits;return void 0!==r&&Object.keys(this.attributes).length>=r&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(this._droppedAttributesCount++,this):(this.attributes[t]=this._truncateToSize(e),this)}setAttributes(t){for(const[e,r]of Object.entries(t))this.setAttribute(e,r);return this}addEvent(t,e,r){if(this._isSpanEnded())return this;const{eventCountLimit:n}=this._spanLimits;if(0===n)return z.warn("No events allowed."),this._droppedEventsCount++,this;void 0!==n&&this.events.length>=n&&(0===this._droppedEventsCount&&z.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),fe(e)&&(fe(r)||(r=e),e=void 0);const i=re(e);return this.events.push({name:t,attributes:i,time:this._getTime(r),droppedAttributesCount:0}),this}addLink(t){return this.links.push(t),this}addLinks(t){return this.links.push(...t),this}setStatus(t){return this._isSpanEnded()||(this.status={...t},null!=this.status.message&&"string"!=typeof t.message&&(z.warn(`Dropping invalid status.message of type '${typeof t.message}', expected 'string'`),delete this.status.message)),this}updateName(t){return this._isSpanEnded()||(this.name=t),this}end(t){this._isSpanEnded()?z.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`):(this._ended=!0,this.endTime=this._getTime(t),this._duration=function(t,e){let r=e[0]-t[0],n=e[1]-t[1];return n<0&&(r-=1,n+=ue),[r,n]}(this.startTime,this.endTime),this._duration[0]<0&&(z.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&z.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnd(this))}_getTime(t){if("number"==typeof t&&t<=ae.now())return de(t+this._performanceOffset);if("number"==typeof t)return le(t);if(t instanceof Date)return le(t.getTime());if(_e(t))return t;if(this._startTimeProvided)return le(Date.now());const e=ae.now()-this._performanceStartTime;return ye(this.startTime,le(e))}isRecording(){return!1===this._ended}recordException(t,e){const r={};"string"==typeof t?r[j]=t:t&&(t.code?r[H]=t.code.toString():t.name&&(r[H]=t.name),t.message&&(r[j]=t.message),t.stack&&(r["exception.stacktrace"]=t.stack)),r[H]||r[j]?this.addEvent("exception",r,e):z.warn(`Failed to record an exception ${t}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){if(this._ended){const t=new Error(`Operation attempted on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`);z.warn(`Cannot execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`,t)}return this._ended}_truncateToLimitUtil(t,e){return t.length<=e?t:t.substring(0,e)}_truncateToSize(t){const e=this._attributeValueLengthLimit;return e<=0?(z.warn(`Attribute value limit must be positive, got ${e}`),t):"string"==typeof t?this._truncateToLimitUtil(t,e):Array.isArray(t)?t.map(t=>"string"==typeof t?this._truncateToLimitUtil(t,e):t):t}}var ve;!function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(ve||(ve={}));class we{shouldSample(){return{decision:ve.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}class be{shouldSample(){return{decision:ve.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}function Te(t){try{(t=>{z.error(function(t){return"string"==typeof t?t:JSON.stringify(function(t){const e={};let r=t;for(;null!==r;)Object.getOwnPropertyNames(r).forEach(t=>{if(e[t])return;const n=r[t];n&&(e[t]=String(n))}),r=Object.getPrototypeOf(r);return e}(t))}(t))})(t)}catch{}}class Ee{_root;_remoteParentSampled;_remoteParentNotSampled;_localParentSampled;_localParentNotSampled;constructor(t){this._root=t.root,this._root||(Te(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new be),this._remoteParentSampled=t.remoteParentSampled??new be,this._remoteParentNotSampled=t.remoteParentNotSampled??new we,this._localParentSampled=t.localParentSampled??new be,this._localParentNotSampled=t.localParentNotSampled??new we}shouldSample(t,e,r,n,i,s){const o=Jt.getSpanContext(t);return o&&Vt(o)?o.isRemote?o.traceFlags&vt.SAMPLED?this._remoteParentSampled.shouldSample(t,e,r,n,i,s):this._remoteParentNotSampled.shouldSample(t,e,r,n,i,s):o.traceFlags&vt.SAMPLED?this._localParentSampled.shouldSample(t,e,r,n,i,s):this._localParentNotSampled.shouldSample(t,e,r,n,i,s):this._root.shouldSample(t,e,r,n,i,s)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}}class Ae{_ratio;_upperBound;constructor(t=0){this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(4294967295*this._ratio)}shouldSample(t,e){return{decision:Gt(e)&&this._accumulate(e)<this._upperBound?ve.RECORD_AND_SAMPLED:ve.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(t){return"number"!=typeof t||isNaN(t)?0:t>=1?1:t<=0?0:t}_accumulate(t){let e=0;for(let r=0;r<t.length/8;r++){const n=8*r;e=(e^parseInt(t.slice(n,n+8),16))>>>0}return e}}var xe;function Ce(){return{sampler:Me(),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128},spanLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128,linkCountLimit:128,eventCountLimit:128,attributePerEventCountLimit:128,attributePerLinkCountLimit:128}}}function Me(){const t=xe.ParentBasedAlwaysOn;switch(t){case xe.AlwaysOn:return new be;case xe.AlwaysOff:return new we;case xe.ParentBasedAlwaysOn:return new Ee({root:new be});case xe.ParentBasedAlwaysOff:return new Ee({root:new we});case xe.TraceIdRatio:return new Ae(Oe());case xe.ParentBasedTraceIdRatio:return new Ee({root:new Ae(Oe())});default:return z.error(`OTEL_TRACES_SAMPLER value "${t}" invalid, defaulting to "${xe.ParentBasedAlwaysOn}".`),new Ee({root:new be})}}function Oe(){return z.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1}!function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"}(xe||(xe={}));const Pe=1/0;class Le{generateTraceId=Ne(16);generateSpanId=Ne(8)}const Re=Array(32);function Ne(t){return function(){for(let e=0;e<2*t;e++)Re[e]=Math.floor(16*Math.random())+48,Re[e]>=58&&(Re[e]+=39);return String.fromCharCode.apply(null,Re.slice(0,2*t))}}class Ie{_sampler;_generalLimits;_spanLimits;_idGenerator;instrumentationScope;_resource;_spanProcessor;constructor(t,e,r,n){const i=function(t){const e={sampler:Me()},r=Ce(),n=Object.assign({},r,e,t);return n.generalLimits=Object.assign({},r.generalLimits,t.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,t.spanLimits||{}),n}(e);this._sampler=i.sampler,this._generalLimits=i.generalLimits,this._spanLimits=i.spanLimits,this._idGenerator=e.idGenerator||new Le,this._resource=r,this._spanProcessor=n,this.instrumentationScope=t}startSpan(t,e={},r=xt.active()){e.root&&(r=Jt.deleteSpan(r));const n=Jt.getSpan(r);if(ee(r))return z.debug("Instrumentation suppressed, returning Noop Span"),Jt.wrapSpanContext(Ot);const i=n?.spanContext(),s=this._idGenerator.generateSpanId();let o,a,c;i&&Jt.isSpanContextValid(i)?(a=i.traceId,c=i.traceState,o=i):a=this._idGenerator.generateTraceId();const u=e.kind??zt.INTERNAL,l=(e.links??[]).map(t=>({context:t.context,attributes:re(t.attributes)})),h=re(e.attributes),d=this._sampler.shouldSample(r,a,t,u,h,l);c=d.traceState??c;const p={traceId:a,spanId:s,traceFlags:d.decision===jt.RECORD_AND_SAMPLED?vt.SAMPLED:vt.NONE,traceState:c};if(d.decision===jt.NOT_RECORD)return z.debug("Recording is off, propagating context in a non-recording span"),Jt.wrapSpanContext(p);const m=re(Object.assign(h,d.attributes));return new Se({resource:this._resource,scope:this.instrumentationScope,context:r,spanContext:p,name:t,kind:u,links:l,parentSpanContext:o,attributes:m,startTime:e.startTime,spanProcessor:this._spanProcessor,spanLimits:this._spanLimits})}startActiveSpan(t,e,r,n){let i,s,o;if(arguments.length<2)return;2===arguments.length?o=e:3===arguments.length?(i=e,o=r):(i=e,s=r,o=n);const a=s??xt.active(),c=this.startSpan(t,i,a),u=Jt.setSpan(a,c);return xt.with(u,o,void 0,c)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}}class Ue{_spanProcessors;constructor(t){this._spanProcessors=t}forceFlush(){const t=[];for(const e of this._spanProcessors)t.push(e.forceFlush());return new Promise(e=>{Promise.all(t).then(()=>{e()}).catch(t=>{Te(t||new Error("MultiSpanProcessor: forceFlush failed")),e()})})}onStart(t,e){for(const r of this._spanProcessors)r.onStart(t,e)}onEnd(t){for(const e of this._spanProcessors)e.onEnd(t)}shutdown(){const t=[];for(const e of this._spanProcessors)t.push(e.shutdown());return new Promise((e,r)=>{Promise.all(t).then(()=>{e()},r)})}}var ke;!function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"}(ke||(ke={}));class De{_config;_tracers=new Map;_resource;_activeSpanProcessor;constructor(t={}){const e=function(...t){let e=t.shift();const r=new WeakMap;for(;t.length>0;)e=pt(e,t.shift(),0,r);return e}({},Ce(),function(t){const e=Object.assign({},t.spanLimits);return e.attributeCountLimit=t.spanLimits?.attributeCountLimit??t.generalLimits?.attributeCountLimit??void 0??void 0??128,e.attributeValueLengthLimit=t.spanLimits?.attributeValueLengthLimit??t.generalLimits?.attributeValueLengthLimit??void 0??void 0??Pe,Object.assign({},t,{spanLimits:e})}(t));this._resource=e.resource??rt(),this._config=Object.assign({},e,{resource:this._resource});const r=[];t.spanProcessors?.length&&r.push(...t.spanProcessors),this._activeSpanProcessor=new Ue(r)}getTracer(t,e,r){const n=`${t}@${e||""}:${r?.schemaUrl||""}`;return this._tracers.has(n)||this._tracers.set(n,new Ie({name:t,version:e,schemaUrl:r?.schemaUrl},this._config,this._resource,this._activeSpanProcessor)),this._tracers.get(n)}forceFlush(){const t=this._config.forceFlushTimeoutMillis,e=this._activeSpanProcessor._spanProcessors.map(e=>new Promise(r=>{let n;const i=setTimeout(()=>{r(new Error(`Span processor did not completed within timeout period of ${t} ms`)),n=ke.timeout},t);e.forceFlush().then(()=>{clearTimeout(i),n!==ke.timeout&&(n=ke.resolved,r(n))}).catch(t=>{clearTimeout(i),n=ke.error,r(t)})}));return new Promise((t,r)=>{Promise.all(e).then(e=>{const n=e.filter(t=>t!==ke.resolved);n.length>0?r(n):t()}).catch(t=>r([t]))})}shutdown(){return this._activeSpanProcessor.shutdown()}}class Be{_enabled=!1;_currentContext=wt;_bindFunction(t=wt,e){const r=this,n=function(...n){return r.with(t,()=>e.apply(this,n))};return Object.defineProperty(n,"length",{enumerable:!1,configurable:!0,writable:!1,value:e.length}),n}active(){return this._currentContext}bind(t,e){return void 0===t&&(t=this.active()),"function"==typeof e?this._bindFunction(t,e):e}disable(){return this._currentContext=wt,this._enabled=!1,this}enable(){return this._enabled||(this._enabled=!0,this._currentContext=wt),this}with(t,e,r,...n){const i=this._currentContext;this._currentContext=t||wt;try{return e.call(r,...n)}finally{this._currentContext=i}}}var Fe=function(){function t(){}return t.prototype.inject=function(t,e){},t.prototype.extract=function(t,e){return t},t.prototype.fields=function(){return[]},t}(),Ge={get:function(t,e){if(null!=t)return t[e]},keys:function(t){return null==t?[]:Object.keys(t)}},Ve={set:function(t,e,r){null!=t&&(t[e]=r)}},$e=St("OpenTelemetry Baggage Key");function ze(t){return t.getValue($e)||void 0}function je(){return ze(At.getInstance().active())}function He(t,e){return t.setValue($e,e)}function qe(t){return t.deleteValue($e)}var We=function(){function t(t){this._entries=t?new Map(t):new Map}return t.prototype.getEntry=function(t){var e=this._entries.get(t);if(e)return Object.assign({},e)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(t){var e=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}(t,2);return[e[0],e[1]]})},t.prototype.setEntry=function(e,r){var n=new t(this._entries);return n._entries.set(e,r),n},t.prototype.removeEntry=function(e){var r=new t(this._entries);return r._entries.delete(e),r},t.prototype.removeEntries=function(){for(var e,r,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=new t(this._entries);try{for(var o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),a=o.next();!a.done;a=o.next()){var c=a.value;s._entries.delete(c)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return s},t.prototype.clear=function(){return new t},t}(),Xe=Symbol("BaggageEntryMetadata"),Ye=G.instance();function Qe(t){return void 0===t&&(t={}),new We(new Map(Object.entries(t)))}var Ke="propagation",Je=new Fe,Ze=function(){function t(){this.createBaggage=Qe,this.getBaggage=ze,this.getActiveBaggage=je,this.setBaggage=He,this.deleteBaggage=qe}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(t){return I(Ke,t,G.instance())},t.prototype.inject=function(t,e,r){return void 0===r&&(r=Ve),this._getGlobalPropagator().inject(t,e,r)},t.prototype.extract=function(t,e,r){return void 0===r&&(r=Ge),this._getGlobalPropagator().extract(t,e,r)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){k(Ke,G.instance())},t.prototype._getGlobalPropagator=function(){return U(Ke)||Je},t}().getInstance();class tr{_propagators;_fields;constructor(t={}){this._propagators=t.propagators??[],this._fields=Array.from(new Set(this._propagators.map(t=>"function"==typeof t.fields?t.fields():[]).reduce((t,e)=>t.concat(e),[])))}inject(t,e,r){for(const n of this._propagators)try{n.inject(t,e,r)}catch(t){z.warn(`Failed to inject with ${n.constructor.name}. Err: ${t.message}`)}}extract(t,e,r){return this._propagators.reduce((t,n)=>{try{return n.extract(t,e,r)}catch(t){z.warn(`Failed to extract with ${n.constructor.name}. Err: ${t.message}`)}return t},t)}fields(){return this._fields.slice()}}const er="[_0-9a-z-*/]",rr=new RegExp(`^(?:[a-z]${er}{0,255}|[a-z0-9]${er}{0,240}@[a-z]${er}{0,13})$`),nr=/^[ -~]{0,255}[!-~]$/,ir=/,|=/;class sr{_internalState=new Map;constructor(t){t&&this._parse(t)}set(t,e){const r=this._clone();return r._internalState.has(t)&&r._internalState.delete(t),r._internalState.set(t,e),r}unset(t){const e=this._clone();return e._internalState.delete(t),e}get(t){return this._internalState.get(t)}serialize(){return this._keys().reduce((t,e)=>(t.push(e+"="+this.get(e)),t),[]).join(",")}_parse(t){t.length>512||(this._internalState=t.split(",").reverse().reduce((t,e)=>{const r=e.trim(),n=r.indexOf("=");if(-1!==n){const i=r.slice(0,n),s=r.slice(n+1,e.length);(function(t){return rr.test(t)})(i)&&function(t){return nr.test(t)&&!ir.test(t)}(s)&&t.set(i,s)}return t},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const t=new sr;return t._internalState=new Map(this._internalState),t}}const or="traceparent",ar="tracestate",cr=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");class ur{inject(t,e,r){const n=Jt.getSpanContext(t);if(!n||ee(t)||!Vt(n))return;const i=`00-${n.traceId}-${n.spanId}-0${Number(n.traceFlags||vt.NONE).toString(16)}`;r.set(e,or,i),n.traceState&&r.set(e,ar,n.traceState.serialize())}extract(t,e,r){const n=r.get(e,or);if(!n)return t;const i=Array.isArray(n)?n[0]:n;if("string"!=typeof i)return t;const s=function(t){const e=cr.exec(t);return e?"00"===e[1]&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}:null}(i);if(!s)return t;s.isRemote=!0;const o=r.get(e,ar);if(o){const t=Array.isArray(o)?o.join(","):o;s.traceState=new sr("string"==typeof t?t:void 0)}return Jt.setSpanContext(t,s)}fields(){return[or,ar]}}const lr="baggage";class hr{inject(t,e,r){const n=Ze.getBaggage(t);if(!n||ee(t))return;const i=function(t){return t.getAllEntries().map(([t,e])=>{let r=`${encodeURIComponent(t)}=${encodeURIComponent(e.value)}`;return void 0!==e.metadata&&(r+=";"+e.metadata.toString()),r})}(n).filter(t=>t.length<=4096).slice(0,180),s=function(t){return t.reduce((t,e)=>{const r=`${t}${""!==t?",":""}${e}`;return r.length>8192?t:r},"")}(i);s.length>0&&r.set(e,lr,s)}extract(t,e,r){const n=r.get(e,lr),i=Array.isArray(n)?n.join(","):n;if(!i)return t;const s={};return 0===i.length?t:(i.split(",").forEach(t=>{const e=function(t){const e=t.split(";");if(e.length<=0)return;const r=e.shift();if(!r)return;const n=r.indexOf("=");if(n<=0)return;const i=decodeURIComponent(r.substring(0,n).trim()),s=decodeURIComponent(r.substring(n+1).trim());let o;var a;return e.length>0&&("string"!=typeof(a=e.join(";"))&&(Ye.error("Cannot create baggage metadata from unknown type: "+typeof a),a=""),o={__TYPE__:Xe,toString:function(){return a}}),{key:i,value:s,metadata:o}}(t);if(e){const t={value:e.value};e.metadata&&(t.metadata=e.metadata),s[e.key]=t}}),0===Object.entries(s).length?t:Ze.setBaggage(t,Ze.createBaggage(s)))}fields(){return[lr]}}class dr extends De{constructor(t={}){super(t)}register(t={}){var e;Jt.setGlobalTracerProvider(this),null!==(e=t.propagator)&&(void 0!==e?Ze.setGlobalPropagator(e):Ze.setGlobalPropagator(new tr({propagators:[new ur,new hr]}))),function(t){if(null!==t){if(void 0===t){const t=new Be;return t.enable(),void xt.setGlobalContextManager(t)}t.enable(),xt.setGlobalContextManager(t)}}(t.contextManager)}}class pr{_promise;_resolve;_reject;constructor(){this._promise=new Promise((t,e)=>{this._resolve=t,this._reject=e})}get promise(){return this._promise}resolve(t){this._resolve(t)}reject(t){this._reject(t)}}class mr{_callback;_that;_isCalled=!1;_deferred=new pr;constructor(t,e){this._callback=t,this._that=e}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...t){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...t)).then(t=>this._deferred.resolve(t),t=>this._deferred.reject(t))}catch(t){this._deferred.reject(t)}}return this._deferred.promise}}var gr;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(gr||(gr={}));class _r{_exporter;_maxExportBatchSize;_maxQueueSize;_scheduledDelayMillis;_exportTimeoutMillis;_isExporting=!1;_finishedSpans=[];_timer;_shutdownOnce;_droppedSpansCount=0;constructor(t,e){this._exporter=t,this._maxExportBatchSize="number"==typeof e?.maxExportBatchSize?e.maxExportBatchSize:512,this._maxQueueSize="number"==typeof e?.maxQueueSize?e.maxQueueSize:2048,this._scheduledDelayMillis="number"==typeof e?.scheduledDelayMillis?e.scheduledDelayMillis:5e3,this._exportTimeoutMillis="number"==typeof e?.exportTimeoutMillis?e.exportTimeoutMillis:3e4,this._shutdownOnce=new mr(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(z.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(t,e){}onEnd(t){this._shutdownOnce.isCalled||0!==(t.spanContext().traceFlags&vt.SAMPLED)&&this._addToBuffer(t)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown())}_addToBuffer(t){if(this._finishedSpans.length>=this._maxQueueSize)return 0===this._droppedSpansCount&&z.debug("maxQueueSize reached, dropping spans"),void this._droppedSpansCount++;this._droppedSpansCount>0&&(z.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(t),this._maybeStartTimer()}_flushAll(){return new Promise((t,e)=>{const r=[];for(let t=0,e=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);t<e;t++)r.push(this._flushOneBatch());Promise.all(r).then(()=>{t()}).catch(e)})}_flushOneBatch(){return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((t,e)=>{const r=setTimeout(()=>{e(new Error("Timeout"))},this._exportTimeoutMillis);xt.with(te(xt.active()),()=>{let n;this._finishedSpans.length<=this._maxExportBatchSize?(n=this._finishedSpans,this._finishedSpans=[]):n=this._finishedSpans.splice(0,this._maxExportBatchSize);const i=()=>this._exporter.export(n,n=>{clearTimeout(r),n.code===gr.SUCCESS?t():e(n.error??new Error("BatchSpanProcessor: span export failed"))});let s=null;for(let t=0,e=n.length;t<e;t++){const e=n[t];e.resource.asyncAttributesPending&&e.resource.waitForAsyncAttributes&&(s??=[],s.push(e.resource.waitForAsyncAttributes()))}null===s?i():Promise.all(s).then(i,t=>{Te(t),e(t)})})})}_maybeStartTimer(){if(this._isExporting)return;const t=()=>{this._isExporting=!0,this._flushOneBatch().finally(()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(t=>{this._isExporting=!1,Te(t)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return t();void 0===this._timer&&(this._timer=setTimeout(()=>t(),this._scheduledDelayMillis),"number"!=typeof this._timer&&this._timer.unref())}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}}class fr extends _r{_visibilityChangeListener;_pageHideListener;constructor(t,e){super(t,e),this.onInit(e)}onInit(t){!0!==t?.disableAutoFlushOnDocumentHide&&"undefined"!=typeof document&&(this._visibilityChangeListener=()=>{"hidden"===document.visibilityState&&this.forceFlush().catch(t=>{Te(t)})},this._pageHideListener=()=>{this.forceFlush().catch(t=>{Te(t)})},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}onShutdown(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}}const yr="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof t.g?t.g:{},Sr=Symbol.for("io.opentelemetry.js.api.logs"),vr=yr;class wr{emit(t){}}const br=new wr,Tr=new class{getLogger(t,e,r){return new wr}};class Er{constructor(t,e,r,n){this._provider=t,this.name=e,this.version=r,this.options=n}emit(t){this._getLogger().emit(t)}_getLogger(){if(this._delegate)return this._delegate;const t=this._provider._getDelegateLogger(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):br}}class Ar{getLogger(t,e,r){var n;return null!==(n=this._getDelegateLogger(t,e,r))&&void 0!==n?n:new Er(this,t,e,r)}_getDelegate(){var t;return null!==(t=this._delegate)&&void 0!==t?t:Tr}_setDelegate(t){this._delegate=t}_getDelegateLogger(t,e,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getLogger(t,e,r)}}class xr{constructor(){this._proxyLoggerProvider=new Ar}static getInstance(){return this._instance||(this._instance=new xr),this._instance}setGlobalLoggerProvider(t){return vr[Sr]?this.getLoggerProvider():(vr[Sr]=(e=t,r=Tr,t=>1===t?e:r),this._proxyLoggerProvider._setDelegate(t),t);var e,r}getLoggerProvider(){var t,e;return null!==(e=null===(t=vr[Sr])||void 0===t?void 0:t.call(vr,1))&&void 0!==e?e:this._proxyLoggerProvider}getLogger(t,e,r){return this.getLoggerProvider().getLogger(t,e,r)}disable(){delete vr[Sr],this._proxyLoggerProvider=new Ar}}const Cr=xr.getInstance();let Mr=console.error.bind(console);function Or(t,e,r){const n=!!t[e]&&Object.prototype.propertyIsEnumerable.call(t,e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}const Pr=(t,e,r)=>{if(!t||!t[e])return void Mr("no original function "+String(e)+" to wrap");if(!r)return Mr("no wrapper function"),void Mr((new Error).stack);const n=t[e];if("function"!=typeof n||"function"!=typeof r)return void Mr("original object and wrapper must be functions");const i=r(n,e);return Or(i,"__original",n),Or(i,"__unwrap",()=>{t[e]===i&&Or(t,e,n)}),Or(i,"__wrapped",!0),Or(t,e,i),i},Lr=(t,e,r)=>{if(!t)return Mr("must provide one or more modules to patch"),void Mr((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach(t=>{e.forEach(e=>{Pr(t,e,r)})}):Mr("must provide one or more functions to wrap on modules")},Rr=(t,e)=>{if(!t||!t[e])return Mr("no function to unwrap."),void Mr((new Error).stack);const r=t[e];r.__unwrap?r.__unwrap():Mr("no original to unwrap to -- has "+String(e)+" already been unwrapped?")},Nr=(t,e)=>{if(!t)return Mr("must provide one or more modules to patch"),void Mr((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach(t=>{e.forEach(e=>{Rr(t,e)})}):Mr("must provide one or more functions to unwrap on modules")};function Ir(t){t&&t.logger&&("function"!=typeof t.logger?Mr("new logger isn't a function, not replacing"):Mr=t.logger)}Ir.wrap=Pr,Ir.massWrap=Lr,Ir.unwrap=Rr,Ir.massUnwrap=Nr;class Ur{instrumentationName;instrumentationVersion;_config={};_tracer;_meter;_logger;_diag;constructor(t,e,r){this.instrumentationName=t,this.instrumentationVersion=e,this.setConfig(r),this._diag=z.createComponentLogger({namespace:t}),this._tracer=Jt.getTracer(t,e),this._meter=$.getMeter(t,e),this._logger=Cr.getLogger(t,e),this._updateMetricInstruments()}_wrap=Pr;_unwrap=Rr;_massWrap=Lr;_massUnwrap=Nr;get meter(){return this._meter}setMeterProvider(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}get logger(){return this._logger}setLoggerProvider(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)}getModuleDefinitions(){const t=this.init()??[];return Array.isArray(t)?t:[t]}_updateMetricInstruments(){}getConfig(){return this._config}setConfig(t){this._config={enabled:!0,...t}}setTracerProvider(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)}get tracer(){return this._tracer}_runSpanCustomizationHook(t,e,r,n){if(t)try{t(r,n)}catch(t){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},t)}}}class kr extends Ur{constructor(t,e,r){super(t,e,r),this._config.enabled&&this.enable()}}var Dr,Br;function Fr(t,e,r){let n,i;try{i=t()}catch(t){n=t}finally{if(e(n,i),n&&!r)throw n;return i}}function Gr(t,e){return"string"==typeof e?t===e:!!t.match(e)}let Vr;function $r(t,e,r,n=!0){if(e in r&&"number"==typeof r[e]&&(!n||0!==r[e]))return t.addEvent(e,r[e])}function zr(t,e,r=!1,n,i){if(void 0===n&&(n=0!==e[Br.START_TIME]),r||($r(t,Br.FETCH_START,e,n),$r(t,Br.DOMAIN_LOOKUP_START,e,n),$r(t,Br.DOMAIN_LOOKUP_END,e,n),$r(t,Br.CONNECT_START,e,n),$r(t,Br.SECURE_CONNECTION_START,e,n),$r(t,Br.CONNECT_END,e,n),$r(t,Br.REQUEST_START,e,n),$r(t,Br.RESPONSE_START,e,n),$r(t,Br.RESPONSE_END,e,n)),!i){const r=e[Br.ENCODED_BODY_SIZE];void 0!==r&&t.setAttribute("http.response_content_length",r);const n=e[Br.DECODED_BODY_SIZE];void 0!==n&&r!==n&&t.setAttribute("http.response_content_length_uncompressed",n)}}function jr(){return"undefined"!=typeof location?location.origin:void 0}function Hr(t){if("function"==typeof URL)return new URL(t,"undefined"!=typeof document?document.baseURI:"undefined"!=typeof location?location.href:void 0);const e=(Vr||(Vr=document.createElement("a")),Vr);return e.href=t,e}var qr;!function(t){t[t.STABLE=1]="STABLE",t[t.OLD=2]="OLD",t[t.DUPLICATE=3]="DUPLICATE"}(Dr||(Dr={})),function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.START_TIME="startTime",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"}(Br||(Br={})),function(t){t.COMPONENT="component",t.HTTP_STATUS_TEXT="http.status_text"}(qr||(qr={}));const Wr=z.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-fetch/utils"});const Xr=new TextEncoder;function Yr(t){return Xr.encode(t).byteLength}const Qr={CONNECT:!0,DELETE:!0,GET:!0,HEAD:!0,OPTIONS:!0,PATCH:!0,POST:!0,PUT:!0,TRACE:!0};let Kr;function Jr(){if(void 0===Kr){const t=void 0;t&&t.length>0?(Kr={},t.forEach(t=>{Kr[t]=!0})):Kr=Qr}return Kr}const Zr={"https:":"443","http:":"80"},tn="0.208.0",en="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof t.g?t.g:{},rn="object"==typeof process&&"node"===process.release?.name;class nn extends kr{component="fetch";version=tn;moduleName=this.component;_usedResources=new WeakSet;_tasksCount=0;_semconvStability;constructor(t={}){super("@opentelemetry/instrumentation-fetch",tn,t),this._semconvStability=function(t,e){let r=Dr.OLD;const n=e?.split(",").map(t=>t.trim()).filter(t=>""!==t);for(const e of n??[]){if(e.toLowerCase()===t+"/dup"){r=Dr.DUPLICATE;break}e.toLowerCase()===t&&(r=Dr.STABLE)}return r}("http",t?.semconvStabilityOptIn)}init(){}_addChildSpan(t,e){const r=this.tracer.startSpan("CORS Preflight",{startTime:e[Br.FETCH_START]},Jt.setSpan(xt.active(),t)),n=!(this._semconvStability&Dr.OLD);zr(r,e,this.getConfig().ignoreNetworkEvents,void 0,n),r.end(e[Br.RESPONSE_END])}_addFinalSpanAttributes(t,e){const r=Hr(e.url);if(this._semconvStability&Dr.OLD&&(t.setAttribute("http.status_code",e.status),null!=e.statusText&&t.setAttribute(qr.HTTP_STATUS_TEXT,e.statusText),t.setAttribute("http.host",r.host),t.setAttribute("http.scheme",r.protocol.replace(":","")),"undefined"!=typeof navigator&&t.setAttribute("http.user_agent",navigator.userAgent)),this._semconvStability&Dr.STABLE){t.setAttribute("http.response.status_code",e.status),t.setAttribute("server.address",r.hostname);const n=function(t){const e=Number(t.port||Zr[t.protocol]);return e&&!isNaN(e)?e:void 0}(r);n&&t.setAttribute("server.port",n)}}_addHeaders(t,e){if(!function(t,e){let r=e||[];return("string"==typeof r||r instanceof RegExp)&&(r=[r]),Hr(t).origin===jr()||r.some(e=>Gr(t,e))}(e,this.getConfig().propagateTraceHeaderCorsUrls)){const t={};return Ze.inject(xt.active(),t),void(Object.keys(t).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}if(t instanceof Request)Ze.inject(xt.active(),t.headers,{set:(t,e,r)=>t.set(e,"string"==typeof r?r:String(r))});else if(t.headers instanceof Headers)Ze.inject(xt.active(),t.headers,{set:(t,e,r)=>t.set(e,"string"==typeof r?r:String(r))});else if(t.headers instanceof Map)Ze.inject(xt.active(),t.headers,{set:(t,e,r)=>t.set(e,"string"==typeof r?r:String(r))});else{const e={};Ze.inject(xt.active(),e),t.headers=Object.assign({},e,t.headers||{})}}_clearResources(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)}_createSpan(t,e={}){if(function(t,e){if(!e)return!1;for(const r of e)if(Gr(t,r))return!0;return!1}(t,this.getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");let r="";const n={};if(this._semconvStability&Dr.OLD){const i=(e.method||"GET").toUpperCase();r=`HTTP ${i}`,n[qr.COMPONENT]=this.moduleName,n["http.method"]=i,n["http.url"]=t}if(this._semconvStability&Dr.STABLE){const i=e.method,s=function(t){const e=Jr(),r=t.toUpperCase();return r in e?r:"_OTHER"}(e.method||"GET");r||(r=s),n["http.request.method"]=s,s!==i&&(n["http.request.method_original"]=i),n["url.full"]=t}return this.tracer.startSpan(r,{kind:zt.CLIENT,attributes:n})}_findResourceAndAddNetworkEvents(t,e,r){let n=e.entries;if(!n.length){if(!performance.getEntriesByType)return;n=performance.getEntriesByType("resource")}const i=function(t,e,r,n,i=new WeakSet,s){const o=Hr(t),a=function(t,e,r,n,i,s){const o=me(e),a=me(r);let c=n.filter(e=>{const r=me(pe(e[Br.FETCH_START])),n=me(pe(e[Br.RESPONSE_END]));return e.initiatorType.toLowerCase()===(s||"xmlhttprequest")&&e.name===t&&r>=o&&n<=a});return c.length>0&&(c=c.filter(t=>!i.has(t))),c}(t=o.toString(),e,r,n,i,s);if(0===a.length)return{mainRequest:void 0};if(1===a.length)return{mainRequest:a[0]};const c=function(t){return t.slice().sort((t,e)=>{const r=t[Br.FETCH_START],n=e[Br.FETCH_START];return r>n?1:r<n?-1:0})}(a);if(o.origin!==jr()&&c.length>1){let t=c[0],e=function(t,e,r){const n=me(r),i=me(pe(e));let s,o=t[1];const a=t.length;for(let e=1;e<a;e++){const r=t[e],a=me(pe(r[Br.FETCH_START])),c=n-me(pe(r[Br.RESPONSE_END]));a>=i&&(!s||c<s)&&(s=c,o=r)}return o}(c,t[Br.RESPONSE_END],r);const n=t[Br.RESPONSE_END];return e[Br.FETCH_START]<n&&(e=t,t=void 0),{corsPreFlightRequest:t,mainRequest:e}}return{mainRequest:a[0]}}(e.spanUrl,e.startTime,r,n,this._usedResources,"fetch");if(i.mainRequest){const e=i.mainRequest;this._markResourceAsUsed(e);const r=i.corsPreFlightRequest;r&&(this._addChildSpan(t,r),this._markResourceAsUsed(r));const n=!(this._semconvStability&Dr.OLD);zr(t,e,this.getConfig().ignoreNetworkEvents,void 0,n)}}_markResourceAsUsed(t){this._usedResources.add(t)}_endSpan(t,e,r){const n=le(Date.now()),i=de();this._addFinalSpanAttributes(t,r),this._semconvStability&Dr.STABLE&&r.status>=400&&(t.setStatus({code:oe.ERROR}),t.setAttribute("error.type",String(r.status))),setTimeout(()=>{e.observer?.disconnect(),this._findResourceAndAddNetworkEvents(t,e,i),this._tasksCount--,this._clearResources(),t.end(n)},300)}_patchConstructor(){return t=>{const e=this;return function(...r){const n=this,i=Hr(r[0]instanceof Request?r[0].url:String(r[0])).href,s=r[0]instanceof Request?r[0]:r[1]||{},o=e._createSpan(i,s);if(!o)return t.apply(this,r);const a=e._prepareSpanData(i);function c(t,r){e._applyAttributesAfterFetch(t,s,r),e._endSpan(t,a,{status:r.status||0,statusText:r.message,url:i})}function u(t,r){e._applyAttributesAfterFetch(t,s,r),r.status>=200&&r.status<400?e._endSpan(t,a,r):e._endSpan(t,a,{status:r.status,statusText:r.statusText,url:i})}function l(t,e,r){let n=null;try{const e=r.clone().body;if(e){const i=e.getReader(),s=204===r.status||205===r.status||304===r.status?null:function(t,e){if(!t)return null;const r=t.getReader();return new ReadableStream({async pull(t){try{const{value:e,done:n}=await r.read();n?(r.releaseLock(),t.close()):t.enqueue(e)}catch(e){t.error(e),r.cancel(e).catch(t=>{});try{r.releaseLock()}catch{}}},cancel:t=>(e.cancel(t).catch(t=>{}),r.cancel(t))})}(r.body,i);n=new Response(s,{status:r.status,statusText:r.statusText,headers:r.headers});const o=()=>{i.read().then(({done:e})=>{e?u(t,r):o()},e=>{c(t,e)})};o()}else u(t,r)}finally{e(n??r)}}function h(t,e,r){try{c(t,r)}finally{e(r)}}return e.getConfig().measureRequestSize&&function(...t){if(t[0]instanceof URL||"string"==typeof t[0]){const r=t[1];if(!r?.body)return Promise.resolve();if(r.body instanceof ReadableStream){const{body:t,length:e}=function(t){if(!t.pipeThrough)return Wr.warn("Platform has ReadableStream but not pipeThrough!"),{body:t,length:Promise.resolve(void 0)};let e,r=0;const n=new Promise(t=>{e=t}),i=new TransformStream({start(){},async transform(t,e){const n=await t;r+=n.byteLength,e.enqueue(t)},flush(){e(r)}});return{body:t.pipeThrough(i),length:n}}(r.body);return r.body=t,e}return Promise.resolve((e=r.body,"undefined"!=typeof Document&&e instanceof Document?(new XMLSerializer).serializeToString(document).length:"string"==typeof e?Yr(e):e instanceof Blob?e.size:e instanceof FormData?function(t){let e=0;for(const[r,n]of t.entries())e+=r.length,n instanceof Blob?e+=n.size:e+=n.length;return e}(e):e instanceof URLSearchParams?Yr(e.toString()):void 0!==e.byteLength?e.byteLength:void Wr.warn("unknown body type")))}var e;{const e=t[0];return e?.body?e.clone().text().then(t=>Yr(t)):Promise.resolve()}}(...r).then(t=>{t&&(e._semconvStability&Dr.OLD&&o.setAttribute("http.request_content_length_uncompressed",t),e._semconvStability&Dr.STABLE&&o.setAttribute("http.request.body.size",t))}).catch(t=>{e._diag.warn("getFetchBodyLength",t)}),new Promise((r,a)=>xt.with(Jt.setSpan(xt.active(),o),()=>(e._addHeaders(s,i),e._callRequestHook(o,s),e._tasksCount++,t.apply(n,s instanceof Request?[s]:[i,s]).then(l.bind(n,o,r),h.bind(n,o,a)))))}}}_applyAttributesAfterFetch(t,e,r){const n=this.getConfig().applyCustomAttributesOnSpan;n&&Fr(()=>n(t,e,r),t=>{t&&this._diag.error("applyCustomAttributesOnSpan",t)},!0)}_callRequestHook(t,e){const r=this.getConfig().requestHook;r&&Fr(()=>r(t,e),t=>{t&&this._diag.error("requestHook",t)},!0)}_prepareSpanData(t){const e=de(),r=[];if("function"!=typeof PerformanceObserver)return{entries:r,startTime:e,spanUrl:t};const n=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{"fetch"===e.initiatorType&&e.name===t&&r.push(e)})});return n.observe({entryTypes:["resource"]}),{entries:r,observer:n,startTime:e,spanUrl:t}}enable(){var t;rn?this._diag.warn("this instrumentation is intended for web usage only, it does not instrument Node.js's fetch()"):("function"==typeof(t=fetch)&&"function"==typeof t.__original&&"function"==typeof t.__unwrap&&!0===t.__wrapped&&(this._unwrap(en,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(en,"fetch",this._patchConstructor()))}disable(){rn||(this._unwrap(en,"fetch"),this._usedResources=new WeakSet)}}class sn{_delegate;constructor(t){this._delegate=t}export(t,e){this._delegate.export(t,e)}forceFlush(){return this._delegate.forceFlush()}shutdown(){return this._delegate.shutdown()}}function on(t){const e={attributes:cn(t.attributes),droppedAttributesCount:0},r=t.schemaUrl;return r&&""!==r&&(e.schemaUrl=r),e}function an(t){return{name:t.name,version:t.version}}function cn(t){return Object.keys(t).map(e=>un(e,t[e]))}function un(t,e){return{key:t,value:ln(e)}}function ln(t){const e=typeof t;return"string"===e?{stringValue:t}:"number"===e?Number.isInteger(t)?{intValue:t}:{doubleValue:t}:"boolean"===e?{boolValue:t}:t instanceof Uint8Array?{bytesValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(ln)}}:"object"===e&&null!=t?{kvlistValue:{values:Object.entries(t).map(([t,e])=>un(t,e))}}:{}}function hn(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function dn(t){const e=new Uint8Array(t.length/2);let r=0;for(let n=0;n<t.length;n+=2){const i=hn(t.charCodeAt(n)),s=hn(t.charCodeAt(n+1));e[r++]=i<<4|s}return e}function pn(t){const e=BigInt(1e9);return BigInt(Math.trunc(t[0]))*e+BigInt(Math.trunc(t[1]))}function mn(t){return e=pn(t),{low:Number(BigInt.asUintN(32,e)),high:Number(BigInt.asUintN(32,e>>BigInt(32)))};var e}const gn="undefined"!=typeof BigInt?function(t){return pn(t).toString()}:me;function _n(t){return t}function fn(t){if(void 0!==t)return dn(t)}const yn={encodeHrTime:mn,encodeSpanContext:dn,encodeOptionalSpanContext:fn};function Sn(t){if(void 0===t)return yn;const e=t.useLongBits??!0,r=t.useHex??!1;return{encodeHrTime:e?mn:gn,encodeSpanContext:r?_n:dn,encodeOptionalSpanContext:r?_n:fn}}function vn(t,e){let r=255&t|256;return e&&(r|=512),r}function wn(t,e){const r=t.spanContext(),n=t.status,i=t.parentSpanContext?.spanId?e.encodeSpanContext(t.parentSpanContext?.spanId):void 0;return{traceId:e.encodeSpanContext(r.traceId),spanId:e.encodeSpanContext(r.spanId),parentSpanId:i,traceState:r.traceState?.serialize(),name:t.name,kind:null==t.kind?0:t.kind+1,startTimeUnixNano:e.encodeHrTime(t.startTime),endTimeUnixNano:e.encodeHrTime(t.endTime),attributes:cn(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map(t=>function(t,e){return{attributes:t.attributes?cn(t.attributes):[],name:t.name,timeUnixNano:e.encodeHrTime(t.time),droppedAttributesCount:t.droppedAttributesCount||0}}(t,e)),droppedEventsCount:t.droppedEventsCount,status:{code:n.code,message:n.message},links:t.links.map(t=>function(t,e){return{attributes:t.attributes?cn(t.attributes):[],spanId:e.encodeSpanContext(t.context.spanId),traceId:e.encodeSpanContext(t.context.traceId),traceState:t.context.traceState?.serialize(),droppedAttributesCount:t.droppedAttributesCount||0,flags:vn(t.context.traceFlags,t.context.isRemote)}}(t,e)),droppedLinksCount:t.droppedLinksCount,flags:vn(r.traceFlags,t.parentSpanContext?.isRemote)}}function bn(t,e){const r=function(t){const e=new Map;for(const r of t){let t=e.get(r.resource);t||(t=new Map,e.set(r.resource,t));const n=`${r.instrumentationScope.name}@${r.instrumentationScope.version||""}:${r.instrumentationScope.schemaUrl||""}`;let i=t.get(n);i||(i=[],t.set(n,i)),i.push(r)}return e}(t),n=[],i=r.entries();let s=i.next();for(;!s.done;){const[t,r]=s.value,o=[],a=r.values();let c=a.next();for(;!c.done;){const t=c.value;if(t.length>0){const r=t.map(t=>wn(t,e));o.push({scope:an(t[0].instrumentationScope),spans:r,schemaUrl:t[0].instrumentationScope.schemaUrl})}c=a.next()}const u=on(t),l={resource:u,scopeSpans:o,schemaUrl:u.schemaUrl};n.push(l),s=i.next()}return n}const Tn={serializeRequest:t=>{const e={resourceSpans:bn(t,Sn({useHex:!0,useLongBits:!1}))};return(new TextEncoder).encode(JSON.stringify(e))},deserializeResponse:t=>{if(0===t.length)return{};const e=new TextDecoder;return JSON.parse(e.decode(t))}};function En(){return.4*Math.random()-.2}class An{_transport;constructor(t){this._transport=t}retry(t,e,r){return new Promise((n,i)=>{setTimeout(()=>{this._transport.send(t,e).then(n,i)},r)})}async send(t,e){const r=Date.now()+e;let n=await this._transport.send(t,e),i=5,s=1e3;for(;"retryable"===n.status&&i>0;){i--;const e=Math.max(Math.min(s,5e3)+En(),0);s*=1.5;const o=n.retryInMillis??e,a=r-Date.now();if(o>a)return n;n=await this.retry(t,a,o)}return n}shutdown(){return this._transport.shutdown()}}function xn(t){return new An(t.transport)}function Cn(t){return[429,502,503,504].includes(t)}function Mn(t){if(null==t)return;const e=Number.parseInt(t,10);if(Number.isInteger(e))return e>0?1e3*e:-1;const r=new Date(t).getTime()-Date.now();return r>=0?r:0}class On{_parameters;constructor(t){this._parameters=t}async send(t,e){const r=await this._parameters.headers();return await new Promise(n=>{const i=new XMLHttpRequest;i.timeout=e,i.open("POST",this._parameters.url),Object.entries(r).forEach(([t,e])=>{i.setRequestHeader(t,e)}),i.ontimeout=t=>{n({status:"failure",error:new Error("XHR request timed out")})},i.onreadystatechange=()=>{i.status>=200&&i.status<=299?(z.debug("XHR success"),n({status:"success"})):i.status&&Cn(i.status)?n({status:"retryable",retryInMillis:Mn(i.getResponseHeader("Retry-After"))}):0!==i.status&&n({status:"failure",error:new Error("XHR request failed with non-retryable status")})},i.onabort=()=>{n({status:"failure",error:new Error("XHR request aborted")})},i.onerror=()=>{n({status:"failure",error:new Error("XHR request errored")})},i.send(t)})}shutdown(){}}class Pn{_params;constructor(t){this._params=t}async send(t){const e=(await this._params.headers())["Content-Type"];return new Promise(r=>{navigator.sendBeacon(this._params.url,new Blob([t],{type:e}))?(z.debug("SendBeacon success"),r({status:"success"})):r({status:"failure",error:new Error("SendBeacon failed")})})}shutdown(){}}class Ln{_concurrencyLimit;_sendingPromises=[];constructor(t){this._concurrencyLimit=t}pushPromise(t){if(this.hasReachedLimit())throw new Error("Concurrency Limit reached");this._sendingPromises.push(t);const e=()=>{const e=this._sendingPromises.indexOf(t);this._sendingPromises.splice(e,1)};t.then(e,e)}hasReachedLimit(){return this._sendingPromises.length>=this._concurrencyLimit}async awaitAll(){await Promise.all(this._sendingPromises)}}function Rn(t){return new Ln(t.concurrencyLimit)}class Nn extends Error{code;name="OTLPExporterError";data;constructor(t,e,r){super(t),this.data=r,this.code=e}}class In{_transport;_serializer;_responseHandler;_promiseQueue;_timeout;_diagLogger;constructor(t,e,r,n,i){this._transport=t,this._serializer=e,this._responseHandler=r,this._promiseQueue=n,this._timeout=i,this._diagLogger=z.createComponentLogger({namespace:"OTLPExportDelegate"})}export(t,e){if(this._diagLogger.debug("items to be sent",t),this._promiseQueue.hasReachedLimit())return void e({code:gr.FAILED,error:new Error("Concurrent export limit reached")});const r=this._serializer.serializeRequest(t);null!=r?this._promiseQueue.pushPromise(this._transport.send(r,this._timeout).then(t=>{if("success"!==t.status)"failure"===t.status&&t.error?e({code:gr.FAILED,error:t.error}):"retryable"===t.status?e({code:gr.FAILED,error:new Nn("Export failed with retryable status")}):e({code:gr.FAILED,error:new Nn("Export failed with unknown error")});else{if(null!=t.data)try{this._responseHandler.handleResponse(this._serializer.deserializeResponse(t.data))}catch(e){this._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",e,t.data)}e({code:gr.SUCCESS})}},t=>e({code:gr.FAILED,error:t}))):e({code:gr.FAILED,error:new Error("Nothing to send")})}forceFlush(){return this._promiseQueue.awaitAll()}async shutdown(){this._diagLogger.debug("shutdown started"),await this.forceFlush(),this._transport.shutdown()}}function Un(t,e,r){return n={transport:r,serializer:e,promiseHandler:Rn(t)},i={timeout:t.timeoutMillis},new In(n.transport,n.serializer,{handleResponse(t){null!=t&&function(t){return Object.prototype.hasOwnProperty.call(t,"partialSuccess")}(t)&&null!=t.partialSuccess&&0!==Object.keys(t.partialSuccess).length&&z.warn("Received Partial Success response:",JSON.stringify(t.partialSuccess))}},n.promiseHandler,i.timeout);var n,i}class kn{_parameters;constructor(t){this._parameters=t}async send(t,e){const r=new AbortController,n=setTimeout(()=>r.abort(),e);try{const e=!!globalThis.location,n=new URL(this._parameters.url),i=await fetch(n.href,{method:"POST",headers:await this._parameters.headers(),body:t,signal:r.signal,keepalive:e,mode:e?globalThis.location?.origin===n.origin?"same-origin":"cors":"no-cors"});if(i.status>=200&&i.status<=299)return z.debug("response success"),{status:"success"};if(Cn(i.status)){return{status:"retryable",retryInMillis:Mn(i.headers.get("Retry-After"))}}return{status:"failure",error:new Error("Fetch request failed with non-retryable status")}}catch(t){return"AbortError"===t?.name?{status:"failure",error:new Error("Fetch request timed out",{cause:t})}:{status:"failure",error:new Error("Fetch request errored",{cause:t})}}finally{clearTimeout(n)}}shutdown(){}}function Dn(t,e){return Un(t,e,xn({transport:(r=t,new On(r))}));var r}function Bn(t,e){return Un(t,e,xn({transport:(r=t,new kn(r))}));var r}function Fn(t,e){return Un(t,e,xn({transport:(r={url:t.url,headers:t.headers},new Pn(r))}));var r}function Gn(t){if(Number.isFinite(t)&&t>0)return t;throw new Error(`Configuration: timeoutMillis is invalid, expected number greater than 0 (actual: '${t}')`)}function Vn(t,e,r){return{timeoutMillis:Gn(t.timeoutMillis??e.timeoutMillis??r.timeoutMillis),concurrencyLimit:t.concurrencyLimit??e.concurrencyLimit??r.concurrencyLimit,compression:t.compression??e.compression??r.compression}}function $n(t){if(null!=t)try{const e=globalThis.location?.href;return new URL(t,e).href}catch{throw new Error(`Configuration: Could not parse user-provided export URL: '${t}'`)}}function zn(t){return"function"==typeof t.headers?t.headers:function(t){if(null!=t)return async()=>t}(t.headers)}function jn(t,e,r,n){return(t.headers||"function"!=typeof navigator.sendBeacon?void 0!==globalThis.fetch?Bn:Dn:Fn)(function(t,e,r){return o={url:t.url,timeoutMillis:t.timeoutMillis,headers:zn(t),concurrencyLimit:t.concurrencyLimit},a={},c=function(t,e){return{timeoutMillis:1e4,concurrencyLimit:30,compression:"none",headers:async()=>t,url:"http://localhost:4318/"+e}}(r,e),{...Vn(o,a,c),headers:(n=o.headers,i=a.headers,s=c.headers,async()=>{const t={...await s()},e={};return null!=i&&Object.assign(e,await i()),null!=n&&Object.assign(e,function(t){const e={};return Object.entries(t??{}).forEach(([t,r])=>{void 0!==r?e[t]=String(r):z.warn(`Header "${t}" has invalid value (${r}) and will be ignored`)}),e}(await n())),Object.assign(e,t)}),url:$n(o.url)??a.url??c.url};var n,i,s,o,a,c}(t,r,n),e)}class Hn extends sn{constructor(t={}){super(jn(t,Tn,"v1/traces",{"Content-Type":"application/json"}))}}var qn,Wn,Xn,Yn;!function(t){t[t.DELTA=0]="DELTA",t[t.CUMULATIVE=1]="CUMULATIVE"}(qn||(qn={})),function(t){t.COUNTER="COUNTER",t.GAUGE="GAUGE",t.HISTOGRAM="HISTOGRAM",t.UP_DOWN_COUNTER="UP_DOWN_COUNTER",t.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",t.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",t.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"}(Wn||(Wn={})),function(t){t[t.HISTOGRAM=0]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",t[t.GAUGE=2]="GAUGE",t[t.SUM=3]="SUM"}(Xn||(Xn={})),function(t){t[t.DROP=0]="DROP",t[t.SUM=1]="SUM",t[t.LAST_VALUE=2]="LAST_VALUE",t[t.HISTOGRAM=3]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=4]="EXPONENTIAL_HISTOGRAM"}(Yn||(Yn={}));class Qn{kind=Yn.DROP;createAccumulation(){}merge(t,e){}diff(t,e){}toMetricData(t,e,r,n){}}class Kn{startTime;monotonic;_current;reset;constructor(t,e,r=0,n=!1){this.startTime=t,this.monotonic=e,this._current=r,this.reset=n}record(t){this.monotonic&&t<0||(this._current+=t)}setStartTime(t){this.startTime=t}toPointValue(){return this._current}}class Jn{monotonic;kind=Yn.SUM;constructor(t){this.monotonic=t}createAccumulation(t){return new Kn(t,this.monotonic)}merge(t,e){const r=t.toPointValue(),n=e.toPointValue();return e.reset?new Kn(e.startTime,this.monotonic,n,e.reset):new Kn(t.startTime,this.monotonic,r+n)}diff(t,e){const r=t.toPointValue(),n=e.toPointValue();return this.monotonic&&r>n?new Kn(e.startTime,this.monotonic,n,!0):new Kn(e.startTime,this.monotonic,n-r)}toMetricData(t,e,r,n){return{descriptor:t,aggregationTemporality:e,dataPointType:Xn.SUM,dataPoints:r.map(([t,e])=>({attributes:t,startTime:e.startTime,endTime:n,value:e.toPointValue()})),isMonotonic:this.monotonic}}}class Zn{startTime;_current;sampleTime;constructor(t,e=0,r=[0,0]){this.startTime=t,this._current=e,this.sampleTime=r}record(t){this._current=t,this.sampleTime=le(Date.now())}setStartTime(t){this.startTime=t}toPointValue(){return this._current}}class ti{kind=Yn.LAST_VALUE;createAccumulation(t){return new Zn(t)}merge(t,e){const r=ge(e.sampleTime)>=ge(t.sampleTime)?e:t;return new Zn(t.startTime,r.toPointValue(),r.sampleTime)}diff(t,e){const r=ge(e.sampleTime)>=ge(t.sampleTime)?e:t;return new Zn(e.startTime,r.toPointValue(),r.sampleTime)}toMetricData(t,e,r,n){return{descriptor:t,aggregationTemporality:e,dataPointType:Xn.GAUGE,dataPoints:r.map(([t,e])=>({attributes:t,startTime:e.startTime,endTime:n,value:e.toPointValue()}))}}}function ei(t){return null!=t}function ri(t){let e=Object.keys(t);return 0===e.length?"":(e=e.sort(),JSON.stringify(e.map(e=>[e,t[e]])))}class ni extends Error{constructor(t){super(t),Object.setPrototypeOf(this,ni.prototype)}}function ii(t,e){let r;const n=new Promise(function(t,n){r=setTimeout(function(){n(new ni("Operation timed out."))},e)});return Promise.race([t,n]).then(t=>(clearTimeout(r),t),t=>{throw clearTimeout(r),t})}function si(t){return"rejected"===t.status}function oi(t,e){const r=[];return t.forEach(t=>{r.push(...e(t))}),r}class ai{startTime;_boundaries;_recordMinMax;_current;constructor(t,e,r=!0,n=function(t){const e=t.map(()=>0);return e.push(0),{buckets:{boundaries:t,counts:e},sum:0,count:0,hasMinMax:!1,min:1/0,max:-1/0}}(e)){this.startTime=t,this._boundaries=e,this._recordMinMax=r,this._current=n}record(t){if(Number.isNaN(t))return;this._current.count+=1,this._current.sum+=t,this._recordMinMax&&(this._current.min=Math.min(t,this._current.min),this._current.max=Math.max(t,this._current.max),this._current.hasMinMax=!0);const e=function(t,e){let r=0,n=t.length-1,i=t.length;for(;n>=r;){const s=r+Math.trunc((n-r)/2);t[s]<e?r=s+1:(i=s,n=s-1)}return i}(this._boundaries,t);this._current.buckets.counts[e]+=1}setStartTime(t){this.startTime=t}toPointValue(){return this._current}}class ci{_boundaries;_recordMinMax;kind=Yn.HISTOGRAM;constructor(t,e){this._boundaries=t,this._recordMinMax=e}createAccumulation(t){return new ai(t,this._boundaries,this._recordMinMax)}merge(t,e){const r=t.toPointValue(),n=e.toPointValue(),i=r.buckets.counts,s=n.buckets.counts,o=new Array(i.length);for(let t=0;t<i.length;t++)o[t]=i[t]+s[t];let a=1/0,c=-1/0;return this._recordMinMax&&(r.hasMinMax&&n.hasMinMax?(a=Math.min(r.min,n.min),c=Math.max(r.max,n.max)):r.hasMinMax?(a=r.min,c=r.max):n.hasMinMax&&(a=n.min,c=n.max)),new ai(t.startTime,r.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:r.buckets.boundaries,counts:o},count:r.count+n.count,sum:r.sum+n.sum,hasMinMax:this._recordMinMax&&(r.hasMinMax||n.hasMinMax),min:a,max:c})}diff(t,e){const r=t.toPointValue(),n=e.toPointValue(),i=r.buckets.counts,s=n.buckets.counts,o=new Array(i.length);for(let t=0;t<i.length;t++)o[t]=s[t]-i[t];return new ai(e.startTime,r.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:r.buckets.boundaries,counts:o},count:n.count-r.count,sum:n.sum-r.sum,hasMinMax:!1,min:1/0,max:-1/0})}toMetricData(t,e,r,n){return{descriptor:t,aggregationTemporality:e,dataPointType:Xn.HISTOGRAM,dataPoints:r.map(([e,r])=>{const i=r.toPointValue(),s=t.type===Wn.GAUGE||t.type===Wn.UP_DOWN_COUNTER||t.type===Wn.OBSERVABLE_GAUGE||t.type===Wn.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:e,startTime:r.startTime,endTime:n,value:{min:i.hasMinMax?i.min:void 0,max:i.hasMinMax?i.max:void 0,sum:s?void 0:i.sum,buckets:i.buckets,count:i.count}}})}}}class ui{backing;indexBase;indexStart;indexEnd;constructor(t=new li,e=0,r=0,n=0){this.backing=t,this.indexBase=e,this.indexStart=r,this.indexEnd=n}get offset(){return this.indexStart}get length(){return 0===this.backing.length||this.indexEnd===this.indexStart&&0===this.at(0)?0:this.indexEnd-this.indexStart+1}counts(){return Array.from({length:this.length},(t,e)=>this.at(e))}at(t){const e=this.indexBase-this.indexStart;return t<e&&(t+=this.backing.length),t-=e,this.backing.countAt(t)}incrementBucket(t,e){this.backing.increment(t,e)}decrementBucket(t,e){this.backing.decrement(t,e)}trim(){for(let t=0;t<this.length;t++){if(0!==this.at(t)){this.indexStart+=t;break}if(t===this.length-1)return void(this.indexStart=this.indexEnd=this.indexBase=0)}for(let t=this.length-1;t>=0;t--)if(0!==this.at(t)){this.indexEnd-=this.length-t-1;break}this._rotate()}downscale(t){this._rotate();const e=1+this.indexEnd-this.indexStart,r=1<<t;let n=0,i=0;for(let t=this.indexStart;t<=this.indexEnd;){let s=t%r;s<0&&(s+=r);for(let o=s;o<r&&n<e;o++)this._relocateBucket(i,n),n++,t++;i++}this.indexStart>>=t,this.indexEnd>>=t,this.indexBase=this.indexStart}clone(){return new ui(this.backing.clone(),this.indexBase,this.indexStart,this.indexEnd)}_rotate(){const t=this.indexBase-this.indexStart;0!==t&&(t>0?(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,t),this.backing.reverse(t,this.backing.length)):(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,this.backing.length+t)),this.indexBase=this.indexStart)}_relocateBucket(t,e){t!==e&&this.incrementBucket(t,this.backing.emptyBucket(e))}}class li{_counts;constructor(t=[0]){this._counts=t}get length(){return this._counts.length}countAt(t){return this._counts[t]}growTo(t,e,r){const n=new Array(t).fill(0);n.splice(r,this._counts.length-e,...this._counts.slice(e)),n.splice(0,e,...this._counts.slice(0,e)),this._counts=n}reverse(t,e){const r=Math.floor((t+e)/2)-t;for(let n=0;n<r;n++){const r=this._counts[t+n];this._counts[t+n]=this._counts[e-n-1],this._counts[e-n-1]=r}}emptyBucket(t){const e=this._counts[t];return this._counts[t]=0,e}increment(t,e){this._counts[t]+=e}decrement(t,e){this._counts[t]>=e?this._counts[t]-=e:this._counts[t]=0}clone(){return new li([...this._counts])}}const hi=Math.pow(2,-1022);function di(t){const e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,t),((2146435072&e.getUint32(0))>>20)-1023}function pi(t){const e=new DataView(new ArrayBuffer(8));e.setFloat64(0,t);const r=e.getUint32(0),n=e.getUint32(4);return(1048575&r)*Math.pow(2,32)+n}function mi(t,e){return 0===t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY||Number.isNaN(t)?t:t*Math.pow(2,e)}class gi extends Error{}class _i{_shift;constructor(t){this._shift=-t}mapToIndex(t){return t<hi?this._minNormalLowerBoundaryIndex():di(t)+this._rightShift(pi(t)-1,52)>>this._shift}lowerBoundary(t){const e=this._minNormalLowerBoundaryIndex();if(t<e)throw new gi(`underflow: ${t} is < minimum lower boundary: ${e}`);const r=this._maxNormalLowerBoundaryIndex();if(t>r)throw new gi(`overflow: ${t} is > maximum lower boundary: ${r}`);return mi(1,t<<this._shift)}get scale(){return 0===this._shift?0:-this._shift}_minNormalLowerBoundaryIndex(){let t=-1022>>this._shift;return this._shift<2&&t--,t}_maxNormalLowerBoundaryIndex(){return 1023>>this._shift}_rightShift(t,e){return Math.floor(t*Math.pow(2,-e))}}class fi{_scale;_scaleFactor;_inverseFactor;constructor(t){this._scale=t,this._scaleFactor=mi(Math.LOG2E,t),this._inverseFactor=mi(Math.LN2,-t)}mapToIndex(t){if(t<=hi)return this._minNormalLowerBoundaryIndex()-1;if(0===pi(t))return(di(t)<<this._scale)-1;const e=Math.floor(Math.log(t)*this._scaleFactor),r=this._maxNormalLowerBoundaryIndex();return e>=r?r:e}lowerBoundary(t){const e=this._maxNormalLowerBoundaryIndex();if(t>=e){if(t===e)return 2*Math.exp((t-(1<<this._scale))/this._scaleFactor);throw new gi(`overflow: ${t} is > maximum lower boundary: ${e}`)}const r=this._minNormalLowerBoundaryIndex();if(t<=r){if(t===r)return hi;if(t===r-1)return Math.exp((t+(1<<this._scale))/this._scaleFactor)/2;throw new gi(`overflow: ${t} is < minimum lower boundary: ${r}`)}return Math.exp(t*this._inverseFactor)}get scale(){return this._scale}_minNormalLowerBoundaryIndex(){return-1022<<this._scale}_maxNormalLowerBoundaryIndex(){return(1024<<this._scale)-1}}const yi=Array.from({length:31},(t,e)=>e>10?new fi(e-10):new _i(e-10));function Si(t){if(t>20||t<-10)throw new gi(`expected scale >= -10 && <= 20, got: ${t}`);return yi[t+10]}class vi{low;high;static combine(t,e){return new vi(Math.min(t.low,e.low),Math.max(t.high,e.high))}constructor(t,e){this.low=t,this.high=e}}class wi{startTime;_maxSize;_recordMinMax;_sum;_count;_zeroCount;_min;_max;_positive;_negative;_mapping;constructor(t,e=160,r=!0,n=0,i=0,s=0,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,c=new ui,u=new ui,l=Si(20)){this.startTime=t,this._maxSize=e,this._recordMinMax=r,this._sum=n,this._count=i,this._zeroCount=s,this._min=o,this._max=a,this._positive=c,this._negative=u,this._mapping=l,this._maxSize<2&&(z.warn(`Exponential Histogram Max Size set to ${this._maxSize},                 changing to the minimum size of: 2`),this._maxSize=2)}record(t){this.updateByIncrement(t,1)}setStartTime(t){this.startTime=t}toPointValue(){return{hasMinMax:this._recordMinMax,min:this.min,max:this.max,sum:this.sum,positive:{offset:this.positive.offset,bucketCounts:this.positive.counts()},negative:{offset:this.negative.offset,bucketCounts:this.negative.counts()},count:this.count,scale:this.scale,zeroCount:this.zeroCount}}get sum(){return this._sum}get min(){return this._min}get max(){return this._max}get count(){return this._count}get zeroCount(){return this._zeroCount}get scale(){return this._count===this._zeroCount?0:this._mapping.scale}get positive(){return this._positive}get negative(){return this._negative}updateByIncrement(t,e){Number.isNaN(t)||(t>this._max&&(this._max=t),t<this._min&&(this._min=t),this._count+=e,0!==t?(this._sum+=t*e,t>0?this._updateBuckets(this._positive,t,e):this._updateBuckets(this._negative,-t,e)):this._zeroCount+=e)}merge(t){0===this._count?(this._min=t.min,this._max=t.max):0!==t.count&&(t.min<this.min&&(this._min=t.min),t.max>this.max&&(this._max=t.max)),this.startTime=t.startTime,this._sum+=t.sum,this._count+=t.count,this._zeroCount+=t.zeroCount;const e=this._minScale(t);this._downscale(this.scale-e),this._mergeBuckets(this.positive,t,t.positive,e),this._mergeBuckets(this.negative,t,t.negative,e)}diff(t){this._min=1/0,this._max=-1/0,this._sum-=t.sum,this._count-=t.count,this._zeroCount-=t.zeroCount;const e=this._minScale(t);this._downscale(this.scale-e),this._diffBuckets(this.positive,t,t.positive,e),this._diffBuckets(this.negative,t,t.negative,e)}clone(){return new wi(this.startTime,this._maxSize,this._recordMinMax,this._sum,this._count,this._zeroCount,this._min,this._max,this.positive.clone(),this.negative.clone(),this._mapping)}_updateBuckets(t,e,r){let n=this._mapping.mapToIndex(e),i=!1,s=0,o=0;if(0===t.length?(t.indexStart=n,t.indexEnd=t.indexStart,t.indexBase=t.indexStart):n<t.indexStart&&t.indexEnd-n>=this._maxSize?(i=!0,o=n,s=t.indexEnd):n>t.indexEnd&&n-t.indexStart>=this._maxSize&&(i=!0,o=t.indexStart,s=n),i){const t=this._changeScale(s,o);this._downscale(t),n=this._mapping.mapToIndex(e)}this._incrementIndexBy(t,n,r)}_incrementIndexBy(t,e,r){if(0===r)return;if(0===t.length&&(t.indexStart=t.indexEnd=t.indexBase=e),e<t.indexStart){const r=t.indexEnd-e;r>=t.backing.length&&this._grow(t,r+1),t.indexStart=e}else if(e>t.indexEnd){const r=e-t.indexStart;r>=t.backing.length&&this._grow(t,r+1),t.indexEnd=e}let n=e-t.indexBase;n<0&&(n+=t.backing.length),t.incrementBucket(n,r)}_grow(t,e){const r=t.backing.length,n=t.indexBase-t.indexStart,i=r-n;let s=(o=e,o--,o|=o>>1,o|=o>>2,o|=o>>4,o|=o>>8,o|=o>>16,++o);var o;s>this._maxSize&&(s=this._maxSize);const a=s-n;t.backing.growTo(s,i,a)}_changeScale(t,e){let r=0;for(;t-e>=this._maxSize;)t>>=1,e>>=1,r++;return r}_downscale(t){if(0===t)return;if(t<0)throw new Error(`impossible change of scale: ${this.scale}`);const e=this._mapping.scale-t;this._positive.downscale(t),this._negative.downscale(t),this._mapping=Si(e)}_minScale(t){const e=Math.min(this.scale,t.scale),r=vi.combine(this._highLowAtScale(this.positive,this.scale,e),this._highLowAtScale(t.positive,t.scale,e)),n=vi.combine(this._highLowAtScale(this.negative,this.scale,e),this._highLowAtScale(t.negative,t.scale,e));return Math.min(e-this._changeScale(r.high,r.low),e-this._changeScale(n.high,n.low))}_highLowAtScale(t,e,r){if(0===t.length)return new vi(0,-1);const n=e-r;return new vi(t.indexStart>>n,t.indexEnd>>n)}_mergeBuckets(t,e,r,n){const i=r.offset,s=e.scale-n;for(let e=0;e<r.length;e++)this._incrementIndexBy(t,i+e>>s,r.at(e))}_diffBuckets(t,e,r,n){const i=r.offset,s=e.scale-n;for(let e=0;e<r.length;e++){let n=(i+e>>s)-t.indexBase;n<0&&(n+=t.backing.length),t.decrementBucket(n,r.at(e))}t.trim()}}class bi{_maxSize;_recordMinMax;kind=Yn.EXPONENTIAL_HISTOGRAM;constructor(t,e){this._maxSize=t,this._recordMinMax=e}createAccumulation(t){return new wi(t,this._maxSize,this._recordMinMax)}merge(t,e){const r=e.clone();return r.merge(t),r}diff(t,e){const r=e.clone();return r.diff(t),r}toMetricData(t,e,r,n){return{descriptor:t,aggregationTemporality:e,dataPointType:Xn.EXPONENTIAL_HISTOGRAM,dataPoints:r.map(([e,r])=>{const i=r.toPointValue(),s=t.type===Wn.GAUGE||t.type===Wn.UP_DOWN_COUNTER||t.type===Wn.OBSERVABLE_GAUGE||t.type===Wn.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:e,startTime:r.startTime,endTime:n,value:{min:i.hasMinMax?i.min:void 0,max:i.hasMinMax?i.max:void 0,sum:s?void 0:i.sum,positive:{offset:i.positive.offset,bucketCounts:i.positive.bucketCounts},negative:{offset:i.negative.offset,bucketCounts:i.negative.bucketCounts},count:i.count,scale:i.scale,zeroCount:i.zeroCount}}})}}}class Ti{static DEFAULT_INSTANCE=new Qn;createAggregator(t){return Ti.DEFAULT_INSTANCE}}class Ei{static MONOTONIC_INSTANCE=new Jn(!0);static NON_MONOTONIC_INSTANCE=new Jn(!1);createAggregator(t){switch(t.type){case Wn.COUNTER:case Wn.OBSERVABLE_COUNTER:case Wn.HISTOGRAM:return Ei.MONOTONIC_INSTANCE;default:return Ei.NON_MONOTONIC_INSTANCE}}}class Ai{static DEFAULT_INSTANCE=new ti;createAggregator(t){return Ai.DEFAULT_INSTANCE}}class xi{static DEFAULT_INSTANCE=new ci([0,5,10,25,50,75,100,250,500,750,1e3,2500,5e3,7500,1e4],!0);createAggregator(t){return xi.DEFAULT_INSTANCE}}class Ci{_recordMinMax;_boundaries;constructor(t,e=!0){if(this._recordMinMax=e,null==t)throw new Error("ExplicitBucketHistogramAggregation should be created with explicit boundaries, if a single bucket histogram is required, please pass an empty array");const r=(t=(t=t.concat()).sort((t,e)=>t-e)).lastIndexOf(-1/0);let n=t.indexOf(1/0);-1===n&&(n=void 0),this._boundaries=t.slice(r+1,n)}createAggregator(t){return new ci(this._boundaries,this._recordMinMax)}}class Mi{_maxSize;_recordMinMax;constructor(t=160,e=!0){this._maxSize=t,this._recordMinMax=e}createAggregator(t){return new bi(this._maxSize,this._recordMinMax)}}const Oi=new Ti,Pi=new Ei,Li=new Ai,Ri=new xi,Ni=(new Mi,new class{_resolve(t){switch(t.type){case Wn.COUNTER:case Wn.UP_DOWN_COUNTER:case Wn.OBSERVABLE_COUNTER:case Wn.OBSERVABLE_UP_DOWN_COUNTER:return Pi;case Wn.GAUGE:case Wn.OBSERVABLE_GAUGE:return Li;case Wn.HISTOGRAM:return t.advice.explicitBucketBoundaries?new Ci(t.advice.explicitBucketBoundaries):Ri}return z.warn(`Unable to recognize instrument type: ${t.type}`),Oi}createAggregator(t){return this._resolve(t).createAggregator(t)}});var Ii,Ui;function ki(t){switch(t.type){case Ii.DEFAULT:return Ni;case Ii.DROP:return Oi;case Ii.SUM:return Pi;case Ii.LAST_VALUE:return Li;case Ii.EXPONENTIAL_HISTOGRAM:{const e=t;return new Mi(e.options?.maxSize,e.options?.recordMinMax)}case Ii.EXPLICIT_BUCKET_HISTOGRAM:{const e=t;return null==e.options?Ri:new Ci(e.options?.boundaries,e.options?.recordMinMax)}default:throw new Error("Unsupported Aggregation")}}!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.DROP=1]="DROP",t[t.SUM=2]="SUM",t[t.LAST_VALUE=3]="LAST_VALUE",t[t.EXPLICIT_BUCKET_HISTOGRAM=4]="EXPLICIT_BUCKET_HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=5]="EXPONENTIAL_HISTOGRAM"}(Ii||(Ii={})),function(t){t[t.DELTA=0]="DELTA",t[t.CUMULATIVE=1]="CUMULATIVE",t[t.LOWMEMORY=2]="LOWMEMORY"}(Ui||(Ui={}));const Di=()=>qn.CUMULATIVE,Bi=t=>{switch(t){case Wn.COUNTER:case Wn.OBSERVABLE_COUNTER:case Wn.GAUGE:case Wn.HISTOGRAM:case Wn.OBSERVABLE_GAUGE:return qn.DELTA;case Wn.UP_DOWN_COUNTER:case Wn.OBSERVABLE_UP_DOWN_COUNTER:return qn.CUMULATIVE}},Fi=t=>{switch(t){case Wn.COUNTER:case Wn.HISTOGRAM:return qn.DELTA;case Wn.GAUGE:case Wn.UP_DOWN_COUNTER:case Wn.OBSERVABLE_UP_DOWN_COUNTER:case Wn.OBSERVABLE_COUNTER:case Wn.OBSERVABLE_GAUGE:return qn.CUMULATIVE}};const Gi=Object.freeze({type:Ii.DEFAULT});class Vi extends sn{_aggregationTemporalitySelector;_aggregationSelector;constructor(t,e){var r;super(t),this._aggregationSelector=function(t){return t?.aggregationPreference??(()=>Gi)}(e),this._aggregationTemporalitySelector=(r=e?.temporalityPreference,null!=r?r===Ui.DELTA?Bi:r===Ui.LOWMEMORY?Fi:Di:function(){const t="cumulative".toLowerCase();return"cumulative"===t?Di:"delta"===t?Bi:"lowmemory"===t?Fi:(z.warn(`OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE is set to '${t}', but only 'cumulative' and 'delta' are allowed. Using default ('cumulative') instead.`),Di)}())}selectAggregation(t){return this._aggregationSelector(t)}selectAggregationTemporality(t){return this._aggregationTemporalitySelector(t)}}var $i,zi;function ji(t,e){return Array.from(t.map(t=>({scope:an(t.scope),metrics:t.metrics.map(t=>function(t,e){const r={name:t.descriptor.name,description:t.descriptor.description,unit:t.descriptor.unit},n=function(t){switch(t){case qn.DELTA:return zi.AGGREGATION_TEMPORALITY_DELTA;case qn.CUMULATIVE:return zi.AGGREGATION_TEMPORALITY_CUMULATIVE}}(t.aggregationTemporality);switch(t.dataPointType){case Xn.SUM:r.sum={aggregationTemporality:n,isMonotonic:t.isMonotonic,dataPoints:Hi(t,e)};break;case Xn.GAUGE:r.gauge={dataPoints:Hi(t,e)};break;case Xn.HISTOGRAM:r.histogram={aggregationTemporality:n,dataPoints:qi(t,e)};break;case Xn.EXPONENTIAL_HISTOGRAM:r.exponentialHistogram={aggregationTemporality:n,dataPoints:Wi(t,e)}}return r}(t,e)),schemaUrl:t.scope.schemaUrl})))}function Hi(t,e){return t.dataPoints.map(r=>function(t,e,r){const n={attributes:cn(t.attributes),startTimeUnixNano:r.encodeHrTime(t.startTime),timeUnixNano:r.encodeHrTime(t.endTime)};switch(e){case $i.INT:n.asInt=t.value;break;case $i.DOUBLE:n.asDouble=t.value}return n}(r,t.descriptor.valueType,e))}function qi(t,e){return t.dataPoints.map(t=>{const r=t.value;return{attributes:cn(t.attributes),bucketCounts:r.buckets.counts,explicitBounds:r.buckets.boundaries,count:r.count,sum:r.sum,min:r.min,max:r.max,startTimeUnixNano:e.encodeHrTime(t.startTime),timeUnixNano:e.encodeHrTime(t.endTime)}})}function Wi(t,e){return t.dataPoints.map(t=>{const r=t.value;return{attributes:cn(t.attributes),count:r.count,min:r.min,max:r.max,sum:r.sum,positive:{offset:r.positive.offset,bucketCounts:r.positive.bucketCounts},negative:{offset:r.negative.offset,bucketCounts:r.negative.bucketCounts},scale:r.scale,zeroCount:r.zeroCount,startTimeUnixNano:e.encodeHrTime(t.startTime),timeUnixNano:e.encodeHrTime(t.endTime)}})}!function(t){t[t.INT=0]="INT",t[t.DOUBLE=1]="DOUBLE"}($i||($i={})),function(t){t[t.AGGREGATION_TEMPORALITY_UNSPECIFIED=0]="AGGREGATION_TEMPORALITY_UNSPECIFIED",t[t.AGGREGATION_TEMPORALITY_DELTA=1]="AGGREGATION_TEMPORALITY_DELTA",t[t.AGGREGATION_TEMPORALITY_CUMULATIVE=2]="AGGREGATION_TEMPORALITY_CUMULATIVE"}(zi||(zi={}));const Xi={serializeRequest:t=>{const e=(r={useLongBits:!1},{resourceMetrics:[t].map(t=>function(t,e){const r=Sn(e),n=on(t.resource);return{resource:n,schemaUrl:n.schemaUrl,scopeMetrics:ji(t.scopeMetrics,r)}}(t,r))});var r;return(new TextEncoder).encode(JSON.stringify(e))},deserializeResponse:t=>{if(0===t.length)return{};const e=new TextDecoder;return JSON.parse(e.decode(t))}};class Yi extends Vi{constructor(t){super(jn(t??{},Xi,"v1/metrics",{"Content-Type":"application/json"}),t)}}class Qi{_registeredViews=[];addView(t){this._registeredViews.push(t)}findViews(t,e){return this._registeredViews.filter(r=>this._matchInstrument(r.instrumentSelector,t)&&this._matchMeter(r.meterSelector,e))}_matchInstrument(t,e){return(void 0===t.getType()||e.type===t.getType())&&t.getNameFilter().match(e.name)&&t.getUnitFilter().match(e.unit)}_matchMeter(t,e){return t.getNameFilter().match(e.name)&&(void 0===e.version||t.getVersionFilter().match(e.version))&&(void 0===e.schemaUrl||t.getSchemaUrlFilter().match(e.schemaUrl))}}function Ki(t,e,r){return function(t){return null!=t.match(Zi)}(t)||z.warn(`Invalid metric name: "${t}". The metric name should be a ASCII string with a length no greater than 255 characters.`),{name:t,type:e,description:r?.description??"",unit:r?.unit??"",valueType:r?.valueType??$i.DOUBLE,advice:r?.advice??{}}}function Ji(t,e){return r=t.name,n=e.name,r.toLowerCase()===n.toLowerCase()&&t.unit===e.unit&&t.type===e.type&&t.valueType===e.valueType;var r,n}const Zi=/^[a-z][a-z0-9_.\-/]{0,254}$/i;class ts{_writableMetricStorage;_descriptor;constructor(t,e){this._writableMetricStorage=t,this._descriptor=e}_record(t,e={},r=xt.active()){"number"==typeof t?(this._descriptor.valueType!==$i.INT||Number.isInteger(t)||(z.warn(`INT value type cannot accept a floating-point value for ${this._descriptor.name}, ignoring the fractional digits.`),t=Math.trunc(t),Number.isInteger(t)))&&this._writableMetricStorage.record(t,e,r,le(Date.now())):z.warn(`non-number value provided to metric ${this._descriptor.name}: ${t}`)}}class es extends ts{add(t,e,r){this._record(t,e,r)}}class rs extends ts{add(t,e,r){t<0?z.warn(`negative value provided to counter ${this._descriptor.name}: ${t}`):this._record(t,e,r)}}class ns extends ts{record(t,e,r){this._record(t,e,r)}}class is extends ts{record(t,e,r){t<0?z.warn(`negative value provided to histogram ${this._descriptor.name}: ${t}`):this._record(t,e,r)}}class ss{_observableRegistry;_metricStorages;_descriptor;constructor(t,e,r){this._observableRegistry=r,this._descriptor=t,this._metricStorages=e}addCallback(t){this._observableRegistry.addCallback(t,this)}removeCallback(t){this._observableRegistry.removeCallback(t,this)}}class os extends ss{}class as extends ss{}class cs extends ss{}function us(t){return t instanceof ss}class ls{_meterSharedState;constructor(t){this._meterSharedState=t}createGauge(t,e){const r=Ki(t,Wn.GAUGE,e),n=this._meterSharedState.registerMetricStorage(r);return new ns(n,r)}createHistogram(t,e){const r=Ki(t,Wn.HISTOGRAM,e),n=this._meterSharedState.registerMetricStorage(r);return new is(n,r)}createCounter(t,e){const r=Ki(t,Wn.COUNTER,e),n=this._meterSharedState.registerMetricStorage(r);return new rs(n,r)}createUpDownCounter(t,e){const r=Ki(t,Wn.UP_DOWN_COUNTER,e),n=this._meterSharedState.registerMetricStorage(r);return new es(n,r)}createObservableGauge(t,e){const r=Ki(t,Wn.OBSERVABLE_GAUGE,e),n=this._meterSharedState.registerAsyncMetricStorage(r);return new as(r,n,this._meterSharedState.observableRegistry)}createObservableCounter(t,e){const r=Ki(t,Wn.OBSERVABLE_COUNTER,e),n=this._meterSharedState.registerAsyncMetricStorage(r);return new os(r,n,this._meterSharedState.observableRegistry)}createObservableUpDownCounter(t,e){const r=Ki(t,Wn.OBSERVABLE_UP_DOWN_COUNTER,e),n=this._meterSharedState.registerAsyncMetricStorage(r);return new cs(r,n,this._meterSharedState.observableRegistry)}addBatchObservableCallback(t,e){this._meterSharedState.observableRegistry.addBatchCallback(t,e)}removeBatchObservableCallback(t,e){this._meterSharedState.observableRegistry.removeBatchCallback(t,e)}}class hs{_instrumentDescriptor;constructor(t){this._instrumentDescriptor=t}getInstrumentDescriptor(){return this._instrumentDescriptor}updateDescription(t){this._instrumentDescriptor=Ki(this._instrumentDescriptor.name,this._instrumentDescriptor.type,{description:t,valueType:this._instrumentDescriptor.valueType,unit:this._instrumentDescriptor.unit,advice:this._instrumentDescriptor.advice})}}class ds{_hash;_valueMap=new Map;_keyMap=new Map;constructor(t){this._hash=t}get(t,e){return e??=this._hash(t),this._valueMap.get(e)}getOrDefault(t,e){const r=this._hash(t);if(this._valueMap.has(r))return this._valueMap.get(r);const n=e();return this._keyMap.has(r)||this._keyMap.set(r,t),this._valueMap.set(r,n),n}set(t,e,r){r??=this._hash(t),this._keyMap.has(r)||this._keyMap.set(r,t),this._valueMap.set(r,e)}has(t,e){return e??=this._hash(t),this._valueMap.has(e)}*keys(){const t=this._keyMap.entries();let e=t.next();for(;!0!==e.done;)yield[e.value[1],e.value[0]],e=t.next()}*entries(){const t=this._valueMap.entries();let e=t.next();for(;!0!==e.done;)yield[this._keyMap.get(e.value[0]),e.value[1],e.value[0]],e=t.next()}get size(){return this._valueMap.size}}class ps extends ds{constructor(){super(ri)}}class ms{_aggregator;_activeCollectionStorage=new ps;_cumulativeMemoStorage=new ps;_cardinalityLimit;_overflowAttributes={"otel.metric.overflow":!0};_overflowHashCode;constructor(t,e){this._aggregator=t,this._cardinalityLimit=(e??2e3)-1,this._overflowHashCode=ri(this._overflowAttributes)}record(t,e,r,n){let i=this._activeCollectionStorage.get(e);if(!i){if(this._activeCollectionStorage.size>=this._cardinalityLimit){const e=this._activeCollectionStorage.getOrDefault(this._overflowAttributes,()=>this._aggregator.createAccumulation(n));return void e?.record(t)}i=this._aggregator.createAccumulation(n),this._activeCollectionStorage.set(e,i)}i?.record(t)}batchCumulate(t,e){Array.from(t.entries()).forEach(([t,r,n])=>{const i=this._aggregator.createAccumulation(e);i?.record(r);let s=i;if(this._cumulativeMemoStorage.has(t,n)){const e=this._cumulativeMemoStorage.get(t,n);s=this._aggregator.diff(e,i)}else if(this._cumulativeMemoStorage.size>=this._cardinalityLimit&&(t=this._overflowAttributes,n=this._overflowHashCode,this._cumulativeMemoStorage.has(t,n))){const e=this._cumulativeMemoStorage.get(t,n);s=this._aggregator.diff(e,i)}if(this._activeCollectionStorage.has(t,n)){const e=this._activeCollectionStorage.get(t,n);s=this._aggregator.merge(e,s)}this._cumulativeMemoStorage.set(t,i,n),this._activeCollectionStorage.set(t,s,n)})}collect(){const t=this._activeCollectionStorage;return this._activeCollectionStorage=new ps,t}}class gs{_aggregator;_unreportedAccumulations=new Map;_reportHistory=new Map;constructor(t,e){this._aggregator=t,e.forEach(t=>{this._unreportedAccumulations.set(t,[])})}buildMetrics(t,e,r,n){this._stashAccumulations(r);const i=this._getMergedUnreportedAccumulations(t);let s,o=i;if(this._reportHistory.has(t)){const e=this._reportHistory.get(t),r=e.collectionTime;s=e.aggregationTemporality,o=s===qn.CUMULATIVE?gs.merge(e.accumulations,i,this._aggregator):gs.calibrateStartTime(e.accumulations,i,r)}else s=t.selectAggregationTemporality(e.type);this._reportHistory.set(t,{accumulations:o,collectionTime:n,aggregationTemporality:s});const a=(c=o,Array.from(c.entries()));var c;if(0!==a.length)return this._aggregator.toMetricData(e,s,a,n)}_stashAccumulations(t){const e=this._unreportedAccumulations.keys();for(const r of e){let e=this._unreportedAccumulations.get(r);void 0===e&&(e=[],this._unreportedAccumulations.set(r,e)),e.push(t)}}_getMergedUnreportedAccumulations(t){let e=new ps;const r=this._unreportedAccumulations.get(t);if(this._unreportedAccumulations.set(t,[]),void 0===r)return e;for(const t of r)e=gs.merge(e,t,this._aggregator);return e}static merge(t,e,r){const n=t,i=e.entries();let s=i.next();for(;!0!==s.done;){const[e,o,a]=s.value;if(t.has(e,a)){const i=t.get(e,a),s=r.merge(i,o);n.set(e,s,a)}else n.set(e,o,a);s=i.next()}return n}static calibrateStartTime(t,e,r){for(const[n,i]of t.keys()){const t=e.get(n,i);t?.setStartTime(r)}return e}}class _s extends hs{_attributesProcessor;_aggregationCardinalityLimit;_deltaMetricStorage;_temporalMetricStorage;constructor(t,e,r,n,i){super(t),this._attributesProcessor=r,this._aggregationCardinalityLimit=i,this._deltaMetricStorage=new ms(e,this._aggregationCardinalityLimit),this._temporalMetricStorage=new gs(e,n)}record(t,e){const r=new ps;Array.from(t.entries()).forEach(([t,e])=>{r.set(this._attributesProcessor.process(t),e)}),this._deltaMetricStorage.batchCumulate(r,e)}collect(t,e){const r=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(t,this._instrumentDescriptor,r,e)}}function fs(t,e){let r="";return t.unit!==e.unit&&(r+=`\t- Unit '${t.unit}' does not match '${e.unit}'\n`),t.type!==e.type&&(r+=`\t- Type '${t.type}' does not match '${e.type}'\n`),t.valueType!==e.valueType&&(r+=`\t- Value Type '${t.valueType}' does not match '${e.valueType}'\n`),t.description!==e.description&&(r+=`\t- Description '${t.description}' does not match '${e.description}'\n`),r}function ys(t,e){return t.valueType!==e.valueType?function(t,e){return`\t- use valueType '${t.valueType}' on instrument creation or use an instrument name other than '${e.name}'`}(t,e):t.unit!==e.unit?function(t,e){return`\t- use unit '${t.unit}' on instrument creation or use an instrument name other than '${e.name}'`}(t,e):t.type!==e.type?function(t,e){const r={name:e.name,type:e.type,unit:e.unit},n=JSON.stringify(r);return`\t- create a new view with a name other than '${t.name}' and InstrumentSelector '${n}'`}(t,e):t.description!==e.description?function(t,e){const r={name:e.name,type:e.type,unit:e.unit},n=JSON.stringify(r);return`\t- create a new view with a name other than '${t.name}' and InstrumentSelector '${n}'\n    \t- OR - create a new view with the name ${t.name} and description '${t.description}' and InstrumentSelector ${n}\n    \t- OR - create a new view with the name ${e.name} and description '${t.description}' and InstrumentSelector ${n}`}(t,e):""}class Ss{_sharedRegistry=new Map;_perCollectorRegistry=new Map;static create(){return new Ss}getStorages(t){let e=[];for(const t of this._sharedRegistry.values())e=e.concat(t);const r=this._perCollectorRegistry.get(t);if(null!=r)for(const t of r.values())e=e.concat(t);return e}register(t){this._registerStorage(t,this._sharedRegistry)}registerForCollector(t,e){let r=this._perCollectorRegistry.get(t);null==r&&(r=new Map,this._perCollectorRegistry.set(t,r)),this._registerStorage(e,r)}findOrUpdateCompatibleStorage(t){const e=this._sharedRegistry.get(t.name);return void 0===e?null:this._findOrUpdateCompatibleStorage(t,e)}findOrUpdateCompatibleCollectorStorage(t,e){const r=this._perCollectorRegistry.get(t);if(void 0===r)return null;const n=r.get(e.name);return void 0===n?null:this._findOrUpdateCompatibleStorage(e,n)}_registerStorage(t,e){const r=t.getInstrumentDescriptor(),n=e.get(r.name);void 0!==n?n.push(t):e.set(r.name,[t])}_findOrUpdateCompatibleStorage(t,e){let r=null;for(const n of e){const e=n.getInstrumentDescriptor();Ji(e,t)?(e.description!==t.description&&(t.description.length>e.description.length&&n.updateDescription(t.description),z.warn("A view or instrument with the name ",t.name," has already been registered, but has a different description and is incompatible with another registered view.\n","Details:\n",fs(e,t),"The longer description will be used.\nTo resolve the conflict:",ys(e,t))),r=n):z.warn("A view or instrument with the name ",t.name," has already been registered and is incompatible with another registered view.\n","Details:\n",fs(e,t),"To resolve the conflict:\n",ys(e,t))}return r}}class vs{_backingStorages;constructor(t){this._backingStorages=t}record(t,e,r,n){this._backingStorages.forEach(i=>{i.record(t,e,r,n)})}}class ws{_instrumentName;_valueType;_buffer=new ps;constructor(t,e){this._instrumentName=t,this._valueType=e}observe(t,e={}){"number"==typeof t?(this._valueType!==$i.INT||Number.isInteger(t)||(z.warn(`INT value type cannot accept a floating-point value for ${this._instrumentName}, ignoring the fractional digits.`),t=Math.trunc(t),Number.isInteger(t)))&&this._buffer.set(e,t):z.warn(`non-number value provided to metric ${this._instrumentName}: ${t}`)}}class bs{_buffer=new Map;observe(t,e,r={}){if(!us(t))return;let n=this._buffer.get(t);null==n&&(n=new ps,this._buffer.set(t,n)),"number"==typeof e?(t._descriptor.valueType!==$i.INT||Number.isInteger(e)||(z.warn(`INT value type cannot accept a floating-point value for ${t._descriptor.name}, ignoring the fractional digits.`),e=Math.trunc(e),Number.isInteger(e)))&&n.set(r,e):z.warn(`non-number value provided to metric ${t._descriptor.name}: ${e}`)}}class Ts{_callbacks=[];_batchCallbacks=[];addCallback(t,e){this._findCallback(t,e)>=0||this._callbacks.push({callback:t,instrument:e})}removeCallback(t,e){const r=this._findCallback(t,e);r<0||this._callbacks.splice(r,1)}addBatchCallback(t,e){const r=new Set(e.filter(us));0!==r.size?this._findBatchCallback(t,r)>=0||this._batchCallbacks.push({callback:t,instruments:r}):z.error("BatchObservableCallback is not associated with valid instruments",e)}removeBatchCallback(t,e){const r=new Set(e.filter(us)),n=this._findBatchCallback(t,r);n<0||this._batchCallbacks.splice(n,1)}async observe(t,e){const r=this._observeCallbacks(t,e),n=this._observeBatchCallbacks(t,e);return(await async function(t){return Promise.all(t.map(async t=>{try{return{status:"fulfilled",value:await t}}catch(t){return{status:"rejected",reason:t}}}))}([...r,...n])).filter(si).map(t=>t.reason)}_observeCallbacks(t,e){return this._callbacks.map(async({callback:r,instrument:n})=>{const i=new ws(n._descriptor.name,n._descriptor.valueType);let s=Promise.resolve(r(i));null!=e&&(s=ii(s,e)),await s,n._metricStorages.forEach(e=>{e.record(i._buffer,t)})})}_observeBatchCallbacks(t,e){return this._batchCallbacks.map(async({callback:r,instruments:n})=>{const i=new bs;let s=Promise.resolve(r(i));null!=e&&(s=ii(s,e)),await s,n.forEach(e=>{const r=i._buffer.get(e);null!=r&&e._metricStorages.forEach(e=>{e.record(r,t)})})})}_findCallback(t,e){return this._callbacks.findIndex(r=>r.callback===t&&r.instrument===e)}_findBatchCallback(t,e){return this._batchCallbacks.findIndex(r=>r.callback===t&&function(t,e){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}(r.instruments,e))}}class Es extends hs{_attributesProcessor;_aggregationCardinalityLimit;_deltaMetricStorage;_temporalMetricStorage;constructor(t,e,r,n,i){super(t),this._attributesProcessor=r,this._aggregationCardinalityLimit=i,this._deltaMetricStorage=new ms(e,this._aggregationCardinalityLimit),this._temporalMetricStorage=new gs(e,n)}record(t,e,r,n){e=this._attributesProcessor.process(e,r),this._deltaMetricStorage.record(t,e,r,n)}collect(t,e){const r=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(t,this._instrumentDescriptor,r,e)}}class As{_processors;constructor(t){this._processors=t}process(t,e){let r=t;for(const t of this._processors)r=t.process(r,e);return r}}function xs(){return Cs}const Cs=new class{process(t,e){return t}};class Ms{_meterProviderSharedState;_instrumentationScope;metricStorageRegistry=new Ss;observableRegistry=new Ts;meter;constructor(t,e){this._meterProviderSharedState=t,this._instrumentationScope=e,this.meter=new ls(this)}registerMetricStorage(t){const e=this._registerMetricStorage(t,Es);return 1===e.length?e[0]:new vs(e)}registerAsyncMetricStorage(t){return this._registerMetricStorage(t,_s)}async collect(t,e,r){const n=await this.observableRegistry.observe(e,r?.timeoutMillis),i=this.metricStorageRegistry.getStorages(t);if(0===i.length)return null;const s=i.map(r=>r.collect(t,e)).filter(ei);return 0===s.length?{errors:n}:{scopeMetrics:{scope:this._instrumentationScope,metrics:s},errors:n}}_registerMetricStorage(t,e){let r=this._meterProviderSharedState.viewRegistry.findViews(t,this._instrumentationScope).map(r=>{const n=function(t,e){return{name:t.name??e.name,description:t.description??e.description,type:e.type,unit:e.unit,valueType:e.valueType,advice:e.advice}}(r,t),i=this.metricStorageRegistry.findOrUpdateCompatibleStorage(n);if(null!=i)return i;const s=r.aggregation.createAggregator(n),o=new e(n,s,r.attributesProcessor,this._meterProviderSharedState.metricCollectors,r.aggregationCardinalityLimit);return this.metricStorageRegistry.register(o),o});if(0===r.length){const n=this._meterProviderSharedState.selectAggregations(t.type).map(([r,n])=>{const i=this.metricStorageRegistry.findOrUpdateCompatibleCollectorStorage(r,t);if(null!=i)return i;const s=n.createAggregator(t),o=r.selectCardinalityLimit(t.type),a=new e(t,s,xs(),[r],o);return this.metricStorageRegistry.registerForCollector(r,a),a});r=r.concat(n)}return r}}class Os{resource;viewRegistry=new Qi;metricCollectors=[];meterSharedStates=new Map;constructor(t){this.resource=t}getMeterSharedState(t){const e=function(t){return`${t.name}:${t.version??""}:${t.schemaUrl??""}`}(t);let r=this.meterSharedStates.get(e);return null==r&&(r=new Ms(this,t),this.meterSharedStates.set(e,r)),r}selectAggregations(t){const e=[];for(const r of this.metricCollectors)e.push([r,ki(r.selectAggregation(t))]);return e}}class Ps{_sharedState;_metricReader;constructor(t,e){this._sharedState=t,this._metricReader=e}async collect(t){const e=le(Date.now()),r=[],n=[],i=Array.from(this._sharedState.meterSharedStates.values()).map(async i=>{const s=await i.collect(this,e,t);null!=s?.scopeMetrics&&r.push(s.scopeMetrics),null!=s?.errors&&n.push(...s.errors)});return await Promise.all(i),{resourceMetrics:{resource:this._sharedState.resource,scopeMetrics:r},errors:n}}async forceFlush(t){await this._metricReader.forceFlush(t)}async shutdown(t){await this._metricReader.shutdown(t)}selectAggregationTemporality(t){return this._metricReader.selectAggregationTemporality(t)}selectAggregation(t){return this._metricReader.selectAggregation(t)}selectCardinalityLimit(t){return this._metricReader.selectCardinalityLimit?.(t)??2e3}}const Ls=/[\^$\\.+?()[\]{}|]/g;class Rs{_matchAll;_regexp;constructor(t){"*"===t?(this._matchAll=!0,this._regexp=/.*/):(this._matchAll=!1,this._regexp=new RegExp(Rs.escapePattern(t)))}match(t){return!!this._matchAll||this._regexp.test(t)}static escapePattern(t){return`^${t.replace(Ls,"\\$&").replace("*",".*")}$`}static hasWildcard(t){return t.includes("*")}}class Ns{_matchAll;_pattern;constructor(t){this._matchAll=void 0===t,this._pattern=t}match(t){return!!this._matchAll||t===this._pattern}}class Is{_nameFilter;_type;_unitFilter;constructor(t){this._nameFilter=new Rs(t?.name??"*"),this._type=t?.type,this._unitFilter=new Ns(t?.unit)}getType(){return this._type}getNameFilter(){return this._nameFilter}getUnitFilter(){return this._unitFilter}}class Us{_nameFilter;_versionFilter;_schemaUrlFilter;constructor(t){this._nameFilter=new Ns(t?.name),this._versionFilter=new Ns(t?.version),this._schemaUrlFilter=new Ns(t?.schemaUrl)}getNameFilter(){return this._nameFilter}getVersionFilter(){return this._versionFilter}getSchemaUrlFilter(){return this._schemaUrlFilter}}class ks{name;description;aggregation;attributesProcessor;instrumentSelector;meterSelector;aggregationCardinalityLimit;constructor(t){var e;!function(t){if(null==(e=t).instrumentName&&null==e.instrumentType&&null==e.instrumentUnit&&null==e.meterName&&null==e.meterVersion&&null==e.meterSchemaUrl)throw new Error("Cannot create view with no selector arguments supplied");var e;if(null!=t.name&&(null==t?.instrumentName||Rs.hasWildcard(t.instrumentName)))throw new Error("Views with a specified name must be declared with an instrument selector that selects at most one instrument per meter.")}(t),null!=t.attributesProcessors?this.attributesProcessor=(e=t.attributesProcessors,new As(e)):this.attributesProcessor=xs(),this.name=t.name,this.description=t.description,this.aggregation=ki(t.aggregation??{type:Ii.DEFAULT}),this.instrumentSelector=new Is({name:t.instrumentName,type:t.instrumentType,unit:t.instrumentUnit}),this.meterSelector=new Us({name:t.meterName,version:t.meterVersion,schemaUrl:t.meterSchemaUrl}),this.aggregationCardinalityLimit=t.aggregationCardinalityLimit}}class Ds{_sharedState;_shutdown=!1;constructor(t){if(this._sharedState=new Os(t?.resource??rt()),null!=t?.views&&t.views.length>0)for(const e of t.views)this._sharedState.viewRegistry.addView(new ks(e));if(null!=t?.readers&&t.readers.length>0)for(const e of t.readers){const t=new Ps(this._sharedState,e);e.setMetricProducer(t),this._sharedState.metricCollectors.push(t)}}getMeter(t,e="",r={}){return this._shutdown?(z.warn("A shutdown MeterProvider cannot provide a Meter"),y):this._sharedState.getMeterSharedState({name:t,version:e,schemaUrl:r.schemaUrl}).meter}async shutdown(t){this._shutdown?z.warn("shutdown may only be called once per MeterProvider"):(this._shutdown=!0,await Promise.all(this._sharedState.metricCollectors.map(e=>e.shutdown(t))))}async forceFlush(t){this._shutdown?z.warn("invalid attempt to force flush after MeterProvider shutdown"):await Promise.all(this._sharedState.metricCollectors.map(e=>e.forceFlush(t)))}}const Bs=function(t,e){return new Promise(r=>{xt.with(te(xt.active()),()=>{t.export(e,t=>{r(t)})})})},Fs=t=>({type:Ii.DEFAULT}),Gs=t=>qn.CUMULATIVE;class Vs{_shutdown=!1;_metricProducers;_sdkMetricProducer;_aggregationTemporalitySelector;_aggregationSelector;_cardinalitySelector;constructor(t){this._aggregationSelector=t?.aggregationSelector??Fs,this._aggregationTemporalitySelector=t?.aggregationTemporalitySelector??Gs,this._metricProducers=t?.metricProducers??[],this._cardinalitySelector=t?.cardinalitySelector}setMetricProducer(t){if(this._sdkMetricProducer)throw new Error("MetricReader can not be bound to a MeterProvider again.");this._sdkMetricProducer=t,this.onInitialized()}selectAggregation(t){return this._aggregationSelector(t)}selectAggregationTemporality(t){return this._aggregationTemporalitySelector(t)}selectCardinalityLimit(t){return this._cardinalitySelector?this._cardinalitySelector(t):2e3}onInitialized(){}async collect(t){if(void 0===this._sdkMetricProducer)throw new Error("MetricReader is not bound to a MetricProducer");if(this._shutdown)throw new Error("MetricReader is shutdown");const[e,...r]=await Promise.all([this._sdkMetricProducer.collect({timeoutMillis:t?.timeoutMillis}),...this._metricProducers.map(e=>e.collect({timeoutMillis:t?.timeoutMillis}))]),n=e.errors.concat(oi(r,t=>t.errors));return{resourceMetrics:{resource:e.resourceMetrics.resource,scopeMetrics:e.resourceMetrics.scopeMetrics.concat(oi(r,t=>t.resourceMetrics.scopeMetrics))},errors:n}}async shutdown(t){this._shutdown?z.error("Cannot call shutdown twice."):(null==t?.timeoutMillis?await this.onShutdown():await ii(this.onShutdown(),t.timeoutMillis),this._shutdown=!0)}async forceFlush(t){this._shutdown?z.warn("Cannot forceFlush on already shutdown MetricReader."):null!=t?.timeoutMillis?await ii(this.onForceFlush(),t.timeoutMillis):await this.onForceFlush()}}class $s extends Vs{_interval;_exporter;_exportInterval;_exportTimeout;constructor(t){if(super({aggregationSelector:t.exporter.selectAggregation?.bind(t.exporter),aggregationTemporalitySelector:t.exporter.selectAggregationTemporality?.bind(t.exporter),metricProducers:t.metricProducers}),void 0!==t.exportIntervalMillis&&t.exportIntervalMillis<=0)throw Error("exportIntervalMillis must be greater than 0");if(void 0!==t.exportTimeoutMillis&&t.exportTimeoutMillis<=0)throw Error("exportTimeoutMillis must be greater than 0");if(void 0!==t.exportTimeoutMillis&&void 0!==t.exportIntervalMillis&&t.exportIntervalMillis<t.exportTimeoutMillis)throw Error("exportIntervalMillis must be greater than or equal to exportTimeoutMillis");this._exportInterval=t.exportIntervalMillis??6e4,this._exportTimeout=t.exportTimeoutMillis??3e4,this._exporter=t.exporter}async _runOnce(){try{await ii(this._doRun(),this._exportTimeout)}catch(t){if(t instanceof ni)return void z.error("Export took longer than %s milliseconds and timed out.",this._exportTimeout);Te(t)}}async _doRun(){const{resourceMetrics:t,errors:e}=await this.collect({timeoutMillis:this._exportTimeout});if(e.length>0&&z.error("PeriodicExportingMetricReader: metrics collection errors",...e),t.resource.asyncAttributesPending)try{await(t.resource.waitForAsyncAttributes?.())}catch(t){z.debug("Error while resolving async portion of resource: ",t),Te(t)}if(0===t.scopeMetrics.length)return;const r=await Bs(this._exporter,t);if(r.code!==gr.SUCCESS)throw new Error(`PeriodicExportingMetricReader: metrics export failed (error ${r.error})`)}onInitialized(){this._interval=setInterval(()=>{this._runOnce()},this._exportInterval),"number"!=typeof this._interval&&this._interval.unref()}async onForceFlush(){await this._runOnce(),await this._exporter.forceFlush()}async onShutdown(){this._interval&&clearInterval(this._interval),await this.onForceFlush(),await this._exporter.shutdown()}}const zs=new Map,js=async t=>{const e=((t="blazor-wasm-client")=>Jt.getTracer(t))(),r={kind:t.kind,attributes:{"hub_open_telemetry.blazor.device_posture":i(),"hub_open_telemetry.blazor.device_memory":navigator.deviceMemory||"unknown","hub_open_telemetry.blazor.device_online_status":navigator.onLine,"hub_open_telemetry.blazor.device_preferred_languages":(navigator.languages||[navigator.language]).join(","),"hub_open_telemetry.blazor.device_storage":await s()}};t.parentContext&&(r.links=[{context:t.parentContext}]);const n=e.startSpan(t.name,r);try{return t.exception?(n.recordException(t.exception),n.setStatus({code:oe.ERROR})):t.eventName&&(n.addEvent(t.eventName,t.eventAttributes??{}),n.setStatus(t.status||{code:oe.OK})),Hs(n)}finally{n.end()}},Hs=t=>{const e=t.spanContext(),r={};return Ze.inject(Jt.setSpan(xt.active(),t),r,Ve),{spanContext:e,traceContext:{traceparent:r.traceparent||`00-${e.traceId}-${e.spanId}-${String(e.traceFlags).padStart(2,"0")}`,tracestate:r.tracestate||""}}};function qs(t){return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=*$/g,"")}function Ws(t){return Uint8Array.from(atob(t.replace(/-/g,"+").replace(/_/g,"/")),t=>t.charCodeAt(0)).buffer}window.HubComponent={},window.HubWebAuthentication={IsWebAuthnPossible:function(){return!!window.PublicKeyCredential},CreateCredentials:async function(t){if("string"==typeof t.challenge&&(t.challenge=Ws(t.challenge)),"string"==typeof t.user.id&&(t.user.id=Ws(t.user.id)),null===t.rp.id&&(t.rp.id=void 0),t.excludeCredentials)for(let e of t.excludeCredentials)"string"==typeof e.id&&(e.id=Ws(e.id));const e=await navigator.credentials.create({publicKey:t}),r=e.response;return{id:(n=e.id,n.replace(/\+/g,"-").replace(/\//g,"_").replace(/=*$/g,"")),rawId:qs(e.rawId),type:e.type,extensions:e.getClientExtensionResults(),response:{attestationObject:qs(r.attestationObject),clientDataJSON:qs(r.clientDataJSON),transports:r.getTransports?r.getTransports():[]}};var n},Verify:async function(t){if("string"==typeof t.challenge&&(t.challenge=Ws(t.challenge)),t.allowCredentials)for(let e=0;e<t.allowCredentials.length;e++){const r=t.allowCredentials[e].id;"string"==typeof r&&(t.allowCredentials[e].id=Ws(r))}const e=await navigator.credentials.get({publicKey:t}),r=e.response;return{id:e.id,rawId:qs(e.rawId),type:e.type,extensions:e.getClientExtensionResults(),response:{authenticatorData:qs(r.authenticatorData),clientDataJSON:qs(r.clientDataJSON),userHandle:r.userHandle&&r.userHandle.byteLength>0?qs(r.userHandle):void 0,signature:qs(r.signature)}}}},window.HubOpenTelemetry={Initialize:t=>{const e=et({[q]:t.serviceName,[W]:t.serviceVersion,"hub_open_telemetry.blazor.device_name":n()});new dr({resource:e,spanProcessors:[new fr(new Hn({url:`${t.gatewayApiUri}/opentelemetry/v1/traces`}),{maxExportBatchSize:100,scheduledDelayMillis:6e4})]}).register(),function(t){const e=t.tracerProvider||Jt.getTracerProvider(),r=t.meterProvider||$.getMeterProvider(),n=t.loggerProvider||Cr.getLoggerProvider();!function(t,e,r,n){for(let i=0,s=t.length;i<s;i++){const s=t[i];e&&s.setTracerProvider(e),r&&s.setMeterProvider(r),n&&s.setLoggerProvider&&s.setLoggerProvider(n),s.getConfig().enabled||s.enable()}}(t.instrumentations?.flat()??[],e,r,n)}({instrumentations:[new nn({propagateTraceHeaderCorsUrls:[new RegExp(`${t.gatewayApiUri}.*`)],clearTimingResources:!0})]});const r=new Ds({resource:e,readers:[new $s({exporter:new Yi({url:`${t.gatewayApiUri}/opentelemetry/v1/metrics`}),exportIntervalMillis:6e4,exportTimeoutMillis:1e4})]});$.setGlobalMeterProvider(r)},TrackEvent:js,TrackException:js,UpdateMetric:t=>{const e=((t="blazor-wasm-client")=>$.getMeter(t))();let r=zs.get(t.name);r||(r=e.createCounter(t.name),zs.set(t.name,r)),r.add(t.value,t.attributes??{})}}})();
//# sourceMappingURL=index.bundle.js.map